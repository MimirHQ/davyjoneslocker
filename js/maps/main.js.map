{"version":3,"sources":["main.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","firebase","initializeApp","database","m_ocean","m_Constants","CameraYOffset","OceanYOffset","OceanPadding","ShipYOffset","SinkDistance","BulletArc","WaitTimePerTileMoved","WaitTimeBetweenAction","m_input","m_ships","m_chain","m_entity","app","init","ships","input","turns","ocean","map","preprocess","doc","document","getElementById","track","createElement","setAttribute","appendChild","render","setTimeout","simulate","data","translate","d","res","hasOwnProperty","atX","atY","x","z","y","actions","index","Math","floor","width","depth","density","console","log","forEach","entry","push","chain","id","type","shipData","camera","String","shipHull","shipMount","shipCannon","name","substring","min","dataset","owner","health","hull","firepower","speed","range","color","sinkShip","Promise","resolve","reject","shipDom","debug","point1","point2","addEventListener","event","removeAttribute","parentNode","removeChild","hasChildNodes","childNodes","fireShip","bullet","source","arc","target","atZ","tmp","moveShip","point","previous","xDistance","zDistance","abs","dur","notStop","current","shift","then","done","catch","err","error","alert","getStrCoord","coord","offsetY","getShips","getOcean","battleship"],"mappings":"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","file":"../main.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\"use strict\";\n\n// Initialize Firebase\nvar config = {\n\tapiKey: \"AIzaSyA9EYUXVL5WAh6Aam1qXlWyvi3b7HLcZ1U\",\n\tauthDomain: \"esigamma.firebaseapp.com\",\n\tdatabaseURL: \"https://esigamma.firebaseio.com\",\n\tprojectId: \"esigamma\",\n\tstorageBucket: \"esigamma.appspot.com\",\n\tmessagingSenderId: \"734163636039\"\n};\nfirebase.initializeApp(config);\n\nvar database = firebase.database();\n\nfunction battleship() {\n\n\t// private\n\tvar m_Constants = {\n\t\tCameraYOffset: 8,\n\t\tOceanYOffset: 0,\n\t\tOceanPadding: 10,\n\t\tShipYOffset: 0,\n\t\tSinkDistance: 5,\n\t\tBulletArc: 2,\n\t\tWaitTimePerTileMoved: 300,\n\t\tWaitTimeBetweenAction: 100 // in miliseconds\n\t};\n\n\tvar m_input = {};\n\n\tvar m_ships = []; // stores formatted json of ship initialization\n\tvar m_chain = []; // stores chainable actions in a turn\n\tvar m_entity = {}; // object with id to html dom element of ships\n\n\tvar m_test = 0;\n\n\tvar m_ocean;\n\n\t// public\n\tvar app = {\n\n\t\tinit: function init() {\n\t\t\t// default access of data when there are no connectivity\n\t\t\tm_input = { \"ships\": input.init.ships, \"turns\": input.turns, \"ocean\": input.init.map };\n\t\t\tapp.preprocess(m_input);\n\n\t\t\tvar doc = document.getElementById('scene');\n\t\t\tvar track = document.createElement('a-curve');\n\t\t\ttrack.setAttribute('id', 'track');\n\t\t\ttrack.setAttribute('type', 'Line');\n\t\t\tdoc.appendChild(track);\n\n\t\t\tapp.render(m_ships);\n\n\t\t\tsetTimeout(function () {\n\t\t\t\tapp.simulate();\n\t\t\t}, 10000);\n\t\t\t// call function to wait a bit before starting simulation\n\t\t\t//app.simulate();\n\t\t},\n\n\t\tpreprocess: function preprocess(data) {\n\t\t\tvar translate = function translate(d) {\n\t\t\t\tvar res = d;\n\t\t\t\tif (res.hasOwnProperty(\"atX\") && res.hasOwnProperty(\"atY\")) {\n\t\t\t\t\tres['atX'] = 4 * d.atX;\n\t\t\t\t\tres['atZ'] = 4 * d.atY; // make sure to move the y property before overriding it\n\t\t\t\t\tres['atY'] = m_Constants.ShipYOffset;\n\t\t\t\t}\n\t\t\t\tres.x = 4 * d.x;\n\t\t\t\tres.z = 4 * d.y; // make sure to move the y property before overriding it\n\t\t\t\tres.y = m_Constants.ShipYOffset;\n\t\t\t\treturn res;\n\t\t\t};\n\t\t\tvar actions = [];\n\t\t\tvar index = 0;\n\n\t\t\t// preprocess initial map information\n\t\t\t// m_ocean = { \"x\": ((4*Math.floor(data.ocean.x/2))-2) + (m_Constants.OceanPadding/2),\n\t\t\t//             \"y\": m_Constants.OceanYOffset, \n\t\t\t//             \"z\": ((4*Math.floor(data.ocean.y/2))) + (m_Constants.OceanPadding/2), \n\t\t\t//             \"width\": (4*data.ocean.x)+m_Constants.OceanPadding, \n\t\t\t//             \"depth\": (4*data.ocean.y)+m_Constants.OceanPadding, \n\t\t\t//             \"density\": Math.min(3*data.ocean.x, 3*data.ocean.y)+m_Constants.OceanPadding\n\t\t\t//         };\n\t\t\tm_ocean = { \"x\": 4 * Math.floor(data.ocean.x / 2) - 2,\n\t\t\t\t\"y\": m_Constants.OceanYOffset,\n\t\t\t\t\"z\": 4 * Math.floor(data.ocean.y / 2),\n\t\t\t\t\"width\": 200,\n\t\t\t\t\"depth\": 200,\n\t\t\t\t\"density\": 120\n\t\t\t};\n\n\t\t\tconsole.log(data);\n\t\t\t// preprocess initial ship information\n\t\t\tdata.ships.forEach(function (entry) {\n\t\t\t\tm_ships.push(translate(entry));\n\t\t\t});\n\n\t\t\t// preprocess actions and turns information\n\t\t\twhile (index < data.turns.length) {\n\t\t\t\tvar chain = true;\n\t\t\t\twhile (chain) {\n\t\t\t\t\tif (index === data.turns.length) break;\n\n\t\t\t\t\tif (actions.length === 0) {\n\t\t\t\t\t\tactions.push(translate(data.turns[index]));\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}\n\t\t\t\t\t// Ship id and action type has to be the same to be considered a chain-able action\n\t\t\t\t\telse if (actions[0].id === data.turns[index].id && actions[0].type === data.turns[index].type) {\n\t\t\t\t\t\t\tif (actions[0].type === \"MOVE\") {\n\t\t\t\t\t\t\t\tactions.push(translate(data.turns[index]));\n\t\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Firing must be at the same coordinates to be considered a chain-able action\n\t\t\t\t\t\t\telse if (actions[0].type === \"FIRE\" && actions[0].atX === 4 * data.turns[index].atX && actions[0].atY === 4 * data.turns[index].atY) {\n\t\t\t\t\t\t\t\t\tactions.push(translate(data.turns[index]));\n\t\t\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t\t\t} else if (actions[0].type === \"SINK\") {\n\t\t\t\t\t\t\t\t\tactions.push(translate(data.turns[index]));\n\t\t\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tchain = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tchain = false;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// add action chain to variable\n\t\t\t\tm_chain.push({ \"type\": actions[0].type, \"actions\": actions });\n\t\t\t\t// reset chain actions\n\t\t\t\tactions = [];\n\t\t\t}\n\t\t\tconsole.log(m_chain);\n\t\t},\n\n\t\t// Displays the ocean, and ships\n\t\t// TODO: check the edge cases with the map edges/sizes\n\t\trender: function render(shipData) {\n\t\t\tvar doc = document.getElementById('scene'); // <a-scene> reference\n\n\t\t\t// re-position camera: camera must be already present when html loads\n\t\t\tvar camera = document.getElementById('camera');\n\t\t\tcamera.setAttribute('position', m_ocean.x + \" \" + m_ocean.y + \" \" + m_ocean.z);\n\t\t\tcamera.setAttribute('camera', 'userHeight: ' + m_Constants.CameraYOffset);\n\n\t\t\t// Generate Map\n\t\t\t// TODO: Possible edge cases with the map edge not being big enough\n\t\t\tvar map = document.createElement('a-ocean');\n\n\t\t\tmap.setAttribute('position', m_ocean.x + \" \" + m_ocean.y + \" \" + m_ocean.z);\n\t\t\tmap.setAttribute('width', String(m_ocean.width));\n\t\t\tmap.setAttribute('depth', String(m_ocean.depth));\n\t\t\tmap.setAttribute('density', String(m_ocean.density));\n\t\t\tdoc.appendChild(map);\n\n\t\t\t// Spawn Ships\n\t\t\tshipData.forEach(function (entry) {\n\t\t\t\tvar shipHull = document.createElement('a-entity');\n\t\t\t\tvar shipMount = document.createElement('a-entity');\n\t\t\t\tvar shipCannon = document.createElement('a-entity');\n\t\t\t\tvar name = document.createElement('a-entity');\n\n\t\t\t\tname.setAttribute('position', \"0 2 0\");\n\t\t\t\tname.setAttribute('look-at', '#camera');\n\t\t\t\tname.setAttribute('text-geometry', \"value: \" + entry.name.substring(0, Math.min(entry.name.length, 24)) + \"; font: #play\");\n\t\t\t\tname.setAttribute('material', 'color: blue;');\n\n\t\t\t\tshipHull.setAttribute('position', entry.x + \" \" + entry.y + \" \" + entry.z);\n\t\t\t\tshipHull.dataset.id = entry.id;\n\t\t\t\tshipHull.dataset.name = entry.name;\n\t\t\t\tshipHull.dataset.owner = entry.owner;\n\t\t\t\tshipHull.dataset.x = entry.x;\n\t\t\t\tshipHull.dataset.y = entry.y;\n\t\t\t\tshipHull.dataset.z = entry.z;\n\t\t\t\tshipHull.dataset.health = entry.hull;\n\t\t\t\tshipHull.dataset.hull = entry.hull;\n\t\t\t\tshipHull.dataset.firepower = entry.firepower;\n\t\t\t\tshipHull.dataset.speed = entry.speed;\n\t\t\t\tshipHull.dataset.range = entry.range;\n\t\t\t\t// shipHull.setAttribute('src', '#ShipHull'); // for collada models\n\t\t\t\tshipHull.setAttribute('obj-model', 'obj: #shipHull');\n\t\t\t\tshipHull.setAttribute('material', 'color: ' + entry.color + '; metalness: 0.4;');\n\n\t\t\t\t//shipMount.setAttribute('material', 'color: '+entry.color+';');\n\t\t\t\tshipMount.setAttribute('obj-model', 'obj: #shipMount');\n\t\t\t\tshipCannon.setAttribute('obj-model', 'obj: #shipCannon');\n\n\t\t\t\tdoc.appendChild(shipHull);\n\t\t\t\tshipHull.appendChild(name);\n\t\t\t\tshipHull.appendChild(shipMount);\n\t\t\t\tshipHull.appendChild(shipCannon);\n\t\t\t\tm_entity[entry.id] = shipHull;\n\t\t\t});\n\t\t},\n\n\t\tsinkShip: function sinkShip(data) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tvar doc = document.getElementById('scene');\n\t\t\t\tvar track = document.getElementById('track');\n\t\t\t\tvar shipDom = m_entity[data[0].id];\n\n\t\t\t\tvar debug = document.createElement('a-draw-curve');\n\t\t\t\tdebug.setAttribute('curveref', '#track');\n\t\t\t\tdebug.setAttribute('material', 'shader: line; color: black;');\n\t\t\t\tdoc.appendChild(debug);\n\n\t\t\t\tvar point1 = document.createElement('a-curve-point');\n\t\t\t\tvar point2 = document.createElement('a-curve-point');\n\t\t\t\tpoint1.setAttribute('position', data[0].x + \" \" + data[0].y + \" \" + data[0].z);\n\t\t\t\tpoint2.setAttribute('position', data[0].x + \" \" + (data[0].y - m_Constants.SinkDistance) + \" \" + data[0].z);\n\t\t\t\ttrack.appendChild(point1);\n\t\t\t\ttrack.appendChild(point2);\n\n\t\t\t\tshipDom.setAttribute('alongpath', 'curve: #track; rotate: true; constraint: 0 1 0; delay: ' + m_Constants.WaitTimeBetweenAction + '; dur: 3000;');\n\n\t\t\t\tvar done = function done(event) {\n\t\t\t\t\tshipDom.removeAttribute('alongpath');\n\t\t\t\t\tif (debug.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(debug);\n\t\t\t\t\t}\n\n\t\t\t\t\twhile (track.hasChildNodes()) {\n\t\t\t\t\t\ttrack.removeChild(track.childNodes[0]);\n\t\t\t\t\t}\n\n\t\t\t\t\t//shipDom.removeEventListener('movingended', done);\n\n\t\t\t\t\tif (shipDom.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(shipDom);\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(event);\n\t\t\t\t};\n\n\t\t\t\tshipDom.addEventListener('movingended', done);\n\t\t\t\t// resolve();\n\t\t\t});\n\t\t},\n\n\t\t// Data passed in are one ships action of firing at one and only one coordinate\n\t\tfireShip: function fireShip(data) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tvar doc = document.getElementById('scene');\n\t\t\t\tvar track = document.getElementById('track');\n\n\t\t\t\tvar bullet = document.createElement('a-sphere');\n\t\t\t\tvar source = document.createElement('a-curve-point');\n\t\t\t\tvar arc = document.createElement('a-curve-point');\n\t\t\t\tvar target = document.createElement('a-curve-point');\n\t\t\t\tbullet.setAttribute('color', 'gray');\n\t\t\t\tbullet.setAttribute('radius', '0.1');\n\t\t\t\tbullet.setAttribute('position', data[0].x + \" \" + data[0].y + \" \" + data[0].z);\n\t\t\t\tsource.setAttribute('position', data[0].x + \" \" + data[0].y + \" \" + data[0].z);\n\t\t\t\ttarget.setAttribute('position', data[0].atX + \" \" + data[0].atY + \" \" + data[0].atZ);\n\t\t\t\tarc.setAttribute('position', (data[0].atX + data[0].x) / 2 + \" \" + ((data[0].atY + data[0].y) / 2 + m_Constants.BulletArc) + \" \" + (data[0].atZ + data[0].z) / 2);\n\t\t\t\ttrack.appendChild(source);\n\t\t\t\ttrack.appendChild(arc);\n\t\t\t\ttrack.appendChild(target);\n\n\t\t\t\tvar debug = document.createElement('a-draw-curve');\n\t\t\t\tdebug.setAttribute('curveref', '#track');\n\t\t\t\tdebug.setAttribute('material', 'shader: line; color: red;');\n\t\t\t\tdoc.appendChild(debug);\n\n\t\t\t\tvar tmp = doc.appendChild(bullet);\n\t\t\t\ttmp.setAttribute('alongpath', 'curve: #track; rotate: true; constant: 0 0 1; delay: 200; dur: 500');\n\n\t\t\t\tvar done = function done(event) {\n\t\t\t\t\ttmp.removeAttribute('alongpath');\n\t\t\t\t\tif (debug.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(debug);\n\t\t\t\t\t}\n\t\t\t\t\twhile (track.hasChildNodes()) {\n\t\t\t\t\t\ttrack.removeChild(track.childNodes[0]);\n\t\t\t\t\t}\n\n\t\t\t\t\t//tmp.removeEventListener('movingended', done);\n\t\t\t\t\tif (tmp.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(tmp);\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(event);\n\t\t\t\t};\n\n\t\t\t\ttmp.addEventListener('movingended', done);\n\t\t\t\t//resolve();\n\t\t\t});\n\t\t},\n\n\t\t// Data passed in must be for movement of one ship\n\t\tmoveShip: function moveShip(data) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\n\t\t\t\tvar shipDom = m_entity[data[0].id]; // html element\n\t\t\t\t// if statement is not working\n\t\t\t\t// if (data.length === 1 && data[0].x === shipDom.dataset.x && data[0].z === shipDom.dataset.z) {\n\t\t\t\t//     // if shipDom tries to move against edge or occupied place\n\t\t\t\t//     alert(\"Skipped\");\n\t\t\t\t//     resolve(\"Skipped\");\n\t\t\t\t// }\n\n\t\t\t\tvar doc = document.getElementById('scene'); // <a-scene> reference\n\t\t\t\tvar track = document.getElementById('track');\n\t\t\t\t//var startCoord = {\"x\": data[0].x};\n\n\t\t\t\tvar debug = document.createElement('a-draw-curve');\n\t\t\t\tdebug.setAttribute('curveref', '#track');\n\t\t\t\tdebug.setAttribute('material', 'shader: line; color: blue;');\n\t\t\t\tdoc.appendChild(debug);\n\n\t\t\t\t// add current location as a starting point of the curve\n\t\t\t\tvar point = document.createElement('a-curve-point');\n\t\t\t\tpoint.setAttribute('position', String(shipDom.dataset.x + \" \" + shipDom.dataset.y + \" \" + shipDom.dataset.z));\n\t\t\t\ttrack.appendChild(point);\n\t\t\t\t// add chain-able goal locations to the curve\n\t\t\t\tvar previous = { 'x': shipDom.dataset.x, 'z': shipDom.dataset.z };\n\t\t\t\tvar xDistance = 0;\n\t\t\t\tvar zDistance = 0;\n\t\t\t\tconsole.log(\"Moving: \", data);\n\t\t\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\t\t\tpoint = document.createElement('a-curve-point');\n\t\t\t\t\tpoint.setAttribute('position', data[i].x + \" \" + data[i].y + \" \" + data[i].z);\n\t\t\t\t\txDistance += Math.abs(data[i].x - previous.x);\n\t\t\t\t\tzDistance += Math.abs(data[i].z - previous.z);\n\t\t\t\t\tif (i + 1 < data.length && data[i].x === data[i + 1].x && data[i].z === data[i + 1].z) {\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\ttrack.appendChild(point);\n\t\t\t\t\tprevious = { 'x': data[i].x, 'z': data[i].z };\n\t\t\t\t}\n\t\t\t\tvar dur = (xDistance + zDistance) * m_Constants.WaitTimePerTileMoved;\n\t\t\t\tshipDom.setAttribute('alongpath', 'curve: #track; rotate: true; constraint: 0 0 1; delay: ' + m_Constants.WaitTimeBetweenAction + '; dur: ' + dur + ';');\n\n\t\t\t\tvar done = function done(event) {\n\t\t\t\t\t// var list = document.getElementByTagName('a-draw-curve');\n\t\t\t\t\t// for (var i = 0; i < list.length; i++) {\n\t\t\t\t\t//     list[0].parentNode.removeChild(list[0]);\n\t\t\t\t\t// }\n\t\t\t\t\tif (debug.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(debug);\n\t\t\t\t\t}\n\n\t\t\t\t\twhile (track.hasChildNodes()) {\n\t\t\t\t\t\ttrack.removeChild(track.childNodes[0]);\n\t\t\t\t\t}\n\n\t\t\t\t\tshipDom.removeAttribute('alongpath');\n\t\t\t\t\tshipDom.dataset.x = data[data.length - 1].x;\n\t\t\t\t\tshipDom.dataset.z = data[data.length - 1].z;\n\t\t\t\t\tshipDom.dataset.y = data[data.length - 1].y;\n\n\t\t\t\t\t//shipDom.removeEventListener('movingended', done);\n\t\t\t\t\tresolve(event);\n\t\t\t\t};\n\n\t\t\t\tshipDom.addEventListener('movingended', done);\n\t\t\t});\n\t\t},\n\n\t\tsimulate: function simulate() {\n\t\t\tconsole.log(\"chain: \", m_chain);\n\t\t\tvar notStop = true;\n\t\t\tif (m_chain.length == 0) {\n\t\t\t\tnotStop = false;\n\t\t\t}\n\t\t\tvar current = m_chain.shift(); // don't shift when length is zero\n\t\t\tif (current && notStop) {\n\t\t\t\tconsole.log(\"current: \", current);\n\t\t\t\tswitch (current.type) {\n\t\t\t\t\tcase \"MOVE\":\n\t\t\t\t\t\tapp.moveShip(current.actions).then(function (done) {\n\t\t\t\t\t\t\t//alert(\"Moved \" + m_chain.length + \" actions left\");\n\t\t\t\t\t\t\tapp.simulate();\n\t\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"FIRE\":\n\t\t\t\t\t\tapp.fireShip(current.actions).then(function (done) {\n\t\t\t\t\t\t\t//alert(\"Fired \" + m_chain.length + \" actions left\");\n\t\t\t\t\t\t\tapp.simulate();\n\t\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"SINK\":\n\t\t\t\t\t\tapp.sinkShip(current.actions).then(function (done) {\n\t\t\t\t\t\t\t//alert(\"Sunk \"+ m_chain.length + \" actions left\");\n\t\t\t\t\t\t\tapp.simulate();\n\t\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.log(\"Unknown Action Type \" + current.type + \" in simulate function\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\talert(\"Simulation Done\");\n\t\t\t\t}, 10000);\n\t\t\t}\n\t\t},\n\n\t\t/** translates the coordinate in the java game to this scene's coordinate\n  \tJava Game: Each ship spans one (x, y) unit\n  \tJava Game: Coordinate system has (0, 0) at top left corner (without negatives)\n  \tAFrame Scene: Each ship model is a 4x4 box\n  \tAFrame Scene: Coordinate system is (0, 0) at the center (with negatives)\n  */\n\t\tgetStrCoord: function getStrCoord(coord, offsetY) {\n\t\t\treturn (m_ocean.x - coord.x) * 4 + \" \" + offsetY + \" \" + (m_ocean.y - coord.y) * 4;\n\t\t},\n\n\t\tgetShips: function getShips() {\n\t\t\treturn m_ships;\n\t\t},\n\n\t\tgetOcean: function getOcean() {\n\t\t\treturn m_ocean;\n\t\t}\n\n\t};\n\n\treturn app;\n}\n\nvar app = battleship();\napp.init();\n\n// var BATTLE_SERVER_URL = 'https://battleship-vingkan.c9users.io/1v1?p1=esi17.cs.DestroyerShip&p2=esi17.hli109.Floater';// + Math.ceil(Math.random() * 100);\n\n// $.get(BATTLE_SERVER_URL).then(data => {\n// \tinput = data;\n// \tapp.init();\n// }).done(() => {\n// \tconsole.log(\"Data successfully retrieved from server\");\n// }).fail(() => {\n// \tconsole.log(\"Unable to retrieve data, starting with local data\");\n// \tapp.init();\n// });\n\n},{}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvbWFpbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUE7QUFDQSxJQUFJLFNBQVM7QUFDWixTQUFRLHlDQURJO0FBRVosYUFBWSwwQkFGQTtBQUdaLGNBQWEsaUNBSEQ7QUFJWixZQUFXLFVBSkM7QUFLWixnQkFBZSxzQkFMSDtBQU1aLG9CQUFtQjtBQU5QLENBQWI7QUFRQSxTQUFTLGFBQVQsQ0FBdUIsTUFBdkI7O0FBRUEsSUFBSSxXQUFXLFNBQVMsUUFBVCxFQUFmOztBQUVBLFNBQVMsVUFBVCxHQUFzQjs7QUFFckI7QUFDQSxLQUFJLGNBQWM7QUFDakIsaUJBQWUsQ0FERTtBQUVqQixnQkFBYyxDQUZHO0FBR2pCLGdCQUFjLEVBSEc7QUFJakIsZUFBYSxDQUpJO0FBS2pCLGdCQUFjLENBTEc7QUFNakIsYUFBVyxDQU5NO0FBT2pCLHdCQUFzQixHQVBMO0FBUWpCLHlCQUF1QixHQVJOLENBUVU7QUFSVixFQUFsQjs7QUFXQSxLQUFJLFVBQVUsRUFBZDs7QUFFQSxLQUFJLFVBQVUsRUFBZCxDQWhCcUIsQ0FnQkg7QUFDbEIsS0FBSSxVQUFVLEVBQWQsQ0FqQnFCLENBaUJIO0FBQ2xCLEtBQUksV0FBVyxFQUFmLENBbEJxQixDQWtCRjs7QUFFbkIsS0FBSSxTQUFTLENBQWI7O0FBRUEsS0FBSSxPQUFKOztBQUVBO0FBQ0EsS0FBSSxNQUFNOztBQUVULFFBQU0sZ0JBQU07QUFDWDtBQUNBLGFBQVUsRUFBQyxTQUFTLE1BQU0sSUFBTixDQUFXLEtBQXJCLEVBQTRCLFNBQVMsTUFBTSxLQUEzQyxFQUFrRCxTQUFTLE1BQU0sSUFBTixDQUFXLEdBQXRFLEVBQVY7QUFDQSxPQUFJLFVBQUosQ0FBZSxPQUFmOztBQUVBLE9BQUksTUFBTSxTQUFTLGNBQVQsQ0FBd0IsT0FBeEIsQ0FBVjtBQUNBLE9BQUksUUFBUSxTQUFTLGFBQVQsQ0FBdUIsU0FBdkIsQ0FBWjtB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UyxVQUFDLEdBQUQsRUFBUztBQUNqQixlQUFRLEtBQVIsQ0FBYyxHQUFkO0FBQ0EsT0FMRDtBQU1BO0FBQ0QsVUFBSyxNQUFMO0FBQ0MsVUFBSSxRQUFKLENBQWEsUUFBUSxPQUFyQixFQUE4QixJQUE5QixDQUFtQyxVQUFDLElBQUQsRUFBVTtBQUM1QztBQUNBLFdBQUksUUFBSjtBQUNBLE9BSEQsRUFHRyxLQUhILENBR1MsVUFBQyxHQUFELEVBQVM7QUFDakIsZUFBUSxLQUFSLENBQWMsR0FBZDtBQUNBLE9BTEQ7QUFNQTtBQUNEO0FBQ0MsY0FBUSxHQUFSLENBQVkseUJBQXlCLFFBQVEsSUFBakMsR0FBd0MsdUJBQXBEO0FBMUJGO0FBNEJBLElBOUJELE1BOEJPO0FBQ04sZUFBVyxZQUFNO0FBQ2hCLFdBQU0saUJBQU47QUFDQSxLQUZELEVBRUcsS0FGSDtBQUdBO0FBRUQsR0F0WFE7O0FBd1hUOzs7Ozs7QUFNQSxlQUFhLHFCQUFDLEtBQUQsRUFBUSxPQUFSLEVBQW9CO0FBQ2hDLFVBQU8sQ0FBQyxRQUFRLENBQVIsR0FBVSxNQUFNLENBQWpCLElBQW9CLENBQXBCLEdBQXdCLEdBQXhCLEdBQThCLE9BQTlCLEdBQXdDLEdBQXhDLEdBQThDLENBQUMsUUFBUSxDQUFSLEdBQVUsTUFBTSxDQUFqQixJQUFvQixDQUF6RTtBQUNBLEdBaFlROztBQWtZVCxZQUFVLG9CQUFNO0FBQ2YsVUFBTyxPQUFQO0FBQ0EsR0FwWVE7O0FBc1lULFlBQVUsb0JBQU07QUFDZixVQUFPLE9BQVA7QUFDQTs7QUF4WVEsRUFBVjs7QUE2WUEsUUFBTyxHQUFQO0FBQ0E7O0FBRUQsSUFBSSxNQUFNLFlBQVY7QUFDQSxJQUFJLElBQUo7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8vIEluaXRpYWxpemUgRmlyZWJhc2VcbnZhciBjb25maWcgPSB7XG5cdGFwaUtleTogXCJBSXphU3lBOUVZVVhWTDVXQWg2QWFtMXFYbFd5dmkzYjdITGNaMVVcIixcblx0YXV0aERvbWFpbjogXCJlc2lnYW1tYS5maXJlYmFzZWFwcC5jb21cIixcblx0ZGF0YWJhc2VVUkw6IFwiaHR0cHM6Ly9lc2lnYW1tYS5maXJlYmFzZWlvLmNvbVwiLFxuXHRwcm9qZWN0SWQ6IFwiZXNpZ2FtbWFcIixcblx0c3RvcmFnZUJ1Y2tldDogXCJlc2lnYW1tYS5hcHBzcG90LmNvbVwiLFxuXHRtZXNzYWdpbmdTZW5kZXJJZDogXCI3MzQxNjM2MzYwMzlcIlxufTtcbmZpcmViYXNlLmluaXRpYWxpemVBcHAoY29uZmlnKTtcblxudmFyIGRhdGFiYXNlID0gZmlyZWJhc2UuZGF0YWJhc2UoKTtcblxuZnVuY3Rpb24gYmF0dGxlc2hpcCgpIHtcblx0XG5cdC8vIHByaXZhdGVcblx0dmFyIG1fQ29uc3RhbnRzID0ge1xuXHRcdENhbWVyYVlPZmZzZXQ6IDgsXG5cdFx0T2NlYW5ZT2Zmc2V0OiAwLFxuXHRcdE9jZWFuUGFkZGluZzogMTAsXG5cdFx0U2hpcFlPZmZzZXQ6IDAsXG5cdFx0U2lua0Rpc3RhbmNlOiA1LFxuXHRcdEJ1bGxldEFyYzogMixcblx0XHRXYWl0VGltZVBlclRpbGVNb3ZlZDogMzAwLFxuXHRcdFdhaXRUaW1lQmV0d2VlbkFjdGlvbjogMTAwIC8vIGluIG1pbGlzZWNvbmRzXG5cdH07XG5cblx0dmFyIG1faW5wdXQgPSB7fTtcblx0XG5cdHZhciBtX3NoaXBzID0gW107IC8vIHN0b3JlcyBmb3JtYXR0ZWQganNvbiBvZiBzaGlwIGluaXRpYWxpemF0aW9uXG5cdHZhciBtX2NoYWluID0gW107IC8vIHN0b3JlcyBjaGFpbmFibGUgYWN0aW9ucyBpbiBhIHR1cm5cblx0dmFyIG1fZW50aXR5ID0ge307IC8vIG9iamVjdCB3aXRoIGlkIHRvIGh0bWwgZG9tIGVsZW1lbnQgb2Ygc2hpcHNcblxuXHR2YXIgbV90ZXN0ID0gMDtcblxuXHR2YXIgbV9vY2VhbjsgXG5cblx0Ly8gcHVibGljXG5cdHZhciBhcHAgPSB7XG5cblx0XHRpbml0OiAoKSA9PiB7XG5cdFx0XHQvLyBkZWZhdWx0IGFjY2VzcyBvZiBkYXRhIHdoZW4gdGhlcmUgYXJlIG5vIGNvbm5lY3Rpdml0eVxuXHRcdFx0bV9pbnB1dCA9IHtcInNoaXBzXCI6IGlucHV0LmluaXQuc2hpcHMsIFwidHVybnNcIjogaW5wdXQudHVybnMsIFwib2NlYW5cIjogaW5wdXQuaW5pdC5tYXB9O1xuXHRcdFx0YXBwLnByZXByb2Nlc3MobV9pbnB1dCk7XG5cblx0XHRcdHZhciBkb2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NlbmUnKTtcblx0XHRcdHZhciB0cmFjayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtY3VydmUnKTtcblx0XHRcdHRyYWNrLnNldEF0dHJpYnV0ZSgnaWQnLCAndHJhY2snKTtcblx0XHRcdHRyYWNrLnNldEF0dHJpYnV0ZSgndHlwZScsICdMaW5lJyk7XG5cdFx0XHRkb2MuYXBwZW5kQ2hpbGQodHJhY2spO1xuXG5cdFx0XHRhcHAucmVuZGVyKG1fc2hpcHMpO1xuXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0YXBwLnNpbXVsYXRlKCk7XG5cdFx0XHR9LCAxMDAwMCk7XG5cdFx0XHQvLyBjYWxsIGZ1bmN0aW9uIHRvIHdhaXQgYSBiaXQgYmVmb3JlIHN0YXJ0aW5nIHNpbXVsYXRpb25cblx0XHRcdC8vYXBwLnNpbXVsYXRlKCk7XG5cdFx0fSxcblxuXHRcdHByZXByb2Nlc3M6IChkYXRhKSA9PiB7XG5cdFx0XHR2YXIgdHJhbnNsYXRlID0gKGQpID0+IHtcblx0XHRcdFx0dmFyIHJlcyA9IGQ7XG5cdFx0XHRcdGlmIChyZXMuaGFzT3duUHJvcGVydHkoXCJhdFhcIikgJiYgcmVzLmhhc093blByb3BlcnR5KFwiYXRZXCIpKSB7XG5cdFx0XHRcdFx0cmVzWydhdFgnXSA9IDQqZC5hdFg7XG5cdFx0XHRcdFx0cmVzWydhdFonXSA9IDQqZC5hdFk7IC8vIG1ha2Ugc3VyZSB0byBtb3ZlIHRoZSB5IHByb3BlcnR5IGJlZm9yZSBvdmVycmlkaW5nIGl0XG5cdFx0XHRcdFx0cmVzWydhdFknXSA9IG1fQ29uc3RhbnRzLlNoaXBZT2Zmc2V0O1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJlcy54ID0gNCpkLng7XG5cdFx0XHRcdHJlcy56ID0gNCpkLnk7IC8vIG1ha2Ugc3VyZSB0byBtb3ZlIHRoZSB5IHByb3BlcnR5IGJlZm9yZSBvdmVycmlkaW5nIGl0XG5cdFx0XHRcdHJlcy55ID0gbV9Db25zdGFudHMuU2hpcFlPZmZzZXQ7XG5cdFx0XHRcdHJldHVybiByZXM7XG5cdFx0XHR9O1xuXHRcdFx0dmFyIGFjdGlvbnMgPSBbXTtcblx0XHRcdHZhciBpbmRleCA9IDA7XG5cblx0XHRcdC8vIHByZXByb2Nlc3MgaW5pdGlhbCBtYXAgaW5mb3JtYXRpb25cblx0XHRcdC8vIG1fb2NlYW4gPSB7IFwieFwiOiAoKDQqTWF0aC5mbG9vcihkYXRhLm9jZWFuLngvMikpLTIpICsgKG1fQ29uc3RhbnRzLk9jZWFuUGFkZGluZy8yKSxcblx0XHRcdC8vICAgICAgICAgICAgIFwieVwiOiBtX0NvbnN0YW50cy5PY2VhbllPZmZzZXQsIFxuXHRcdFx0Ly8gICAgICAgICAgICAgXCJ6XCI6ICgoNCpNYXRoLmZsb29yKGRhdGEub2NlYW4ueS8yKSkpICsgKG1fQ29uc3RhbnRzLk9jZWFuUGFkZGluZy8yKSwgXG5cdFx0XHQvLyAgICAgICAgICAgICBcIndpZHRoXCI6ICg0KmRhdGEub2NlYW4ueCkrbV9Db25zdGFudHMuT2NlYW5QYWRkaW5nLCBcblx0XHRcdC8vICAgICAgICAgICAgIFwiZGVwdGhcIjogKDQqZGF0YS5vY2Vhbi55KSttX0NvbnN0YW50cy5PY2VhblBhZGRpbmcsIFxuXHRcdFx0Ly8gICAgICAgICAgICAgXCJkZW5zaXR5XCI6IE1hdGgubWluKDMqZGF0YS5vY2Vhbi54LCAzKmRhdGEub2NlYW4ueSkrbV9Db25zdGFudHMuT2NlYW5QYWRkaW5nXG5cdFx0XHQvLyAgICAgICAgIH07XG5cdFx0XHRtX29jZWFuID0geyBcInhcIjogKCg0Kk1hdGguZmxvb3IoZGF0YS5vY2Vhbi54LzIpKS0yKSxcblx0XHRcdFx0XHRcdFwieVwiOiBtX0NvbnN0YW50cy5PY2VhbllPZmZzZXQsIFxuXHRcdFx0XHRcdFx0XCJ6XCI6ICgoNCpNYXRoLmZsb29yKGRhdGEub2NlYW4ueS8yKSkpLFxuXHRcdFx0XHRcdFx0XCJ3aWR0aFwiOiAyMDAsIFxuXHRcdFx0XHRcdFx0XCJkZXB0aFwiOiAyMDAsXG5cdFx0XHRcdFx0XHRcImRlbnNpdHlcIjogMTIwLFxuXHRcdFx0XHRcdH07XG5cblx0XHRcdGNvbnNvbGUubG9nKGRhdGEpO1xuXHRcdFx0Ly8gcHJlcHJvY2VzcyBpbml0aWFsIHNoaXAgaW5mb3JtYXRpb25cblx0XHRcdGRhdGEuc2hpcHMuZm9yRWFjaCgoZW50cnkpID0+IHtcblx0XHRcdFx0bV9zaGlwcy5wdXNoKHRyYW5zbGF0ZShlbnRyeSkpO1xuXHRcdFx0fSk7XG5cblx0XHRcdC8vIHByZXByb2Nlc3MgYWN0aW9ucyBhbmQgdHVybnMgaW5mb3JtYXRpb25cblx0XHRcdHdoaWxlKGluZGV4IDwgZGF0YS50dXJucy5sZW5ndGgpIHtcblx0XHRcdFx0dmFyIGNoYWluID0gdHJ1ZTtcblx0XHRcdFx0d2hpbGUoY2hhaW4pIHtcblx0XHRcdFx0XHRpZiAoaW5kZXggPT09IGRhdGEudHVybnMubGVuZ3RoKVxuXHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRpZiAoYWN0aW9ucy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHRcdGFjdGlvbnMucHVzaCh0cmFuc2xhdGUoZGF0YS50dXJuc1tpbmRleF0pKTtcblx0XHRcdFx0XHRcdGluZGV4Kys7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdC8vIFNoaXAgaWQgYW5kIGFjdGlvbiB0eXBlIGhhcyB0byBiZSB0aGUgc2FtZSB0byBiZSBjb25zaWRlcmVkIGEgY2hhaW4tYWJsZSBhY3Rpb25cblx0XHRcdFx0XHRlbHNlIGlmIChhY3Rpb25zWzBdLmlkID09PSBkYXRhLnR1cm5zW2luZGV4XS5pZCAmJiBhY3Rpb25zWzBdLnR5cGUgPT09IGRhdGEudHVybnNbaW5kZXhdLnR5cGUpIHtcblx0XHRcdFx0XHRcdGlmIChhY3Rpb25zWzBdLnR5cGUgPT09IFwiTU9WRVwiKSB7XG5cdFx0XHRcdFx0XHRcdGFjdGlvbnMucHVzaCh0cmFuc2xhdGUoZGF0YS50dXJuc1tpbmRleF0pKTtcblx0XHRcdFx0XHRcdFx0aW5kZXgrKztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdC8vIEZpcmluZyBtdXN0IGJlIGF0IHRoZSBzYW1lIGNvb3JkaW5hdGVzIHRvIGJlIGNvbnNpZGVyZWQgYSBjaGFpbi1hYmxlIGFjdGlvblxuXHRcdFx0XHRcdFx0ZWxzZSBpZiAoYWN0aW9uc1swXS50eXBlID09PSBcIkZJUkVcIiAmJiBhY3Rpb25zWzBdLmF0WCA9PT0gNCooZGF0YS50dXJuc1tpbmRleF0uYXRYKSAmJiBhY3Rpb25zWzBdLmF0WSA9PT0gNCooZGF0YS50dXJuc1tpbmRleF0uYXRZKSkge1xuXHRcdFx0XHRcdFx0XHRhY3Rpb25zLnB1c2godHJhbnNsYXRlKGRhdGEudHVybnNbaW5kZXhdKSk7XG5cdFx0XHRcdFx0XHRcdGluZGV4Kys7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRlbHNlIGlmKGFjdGlvbnNbMF0udHlwZSA9PT0gXCJTSU5LXCIpIHtcblx0XHRcdFx0XHRcdFx0YWN0aW9ucy5wdXNoKHRyYW5zbGF0ZShkYXRhLnR1cm5zW2luZGV4XSkpO1xuXHRcdFx0XHRcdFx0XHRpbmRleCsrO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGNoYWluID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0Y2hhaW4gPSBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gYWRkIGFjdGlvbiBjaGFpbiB0byB2YXJpYWJsZVxuXHRcdFx0XHRtX2NoYWluLnB1c2goe1widHlwZVwiOiBhY3Rpb25zWzBdLnR5cGUsIFwiYWN0aW9uc1wiOiBhY3Rpb25zfSk7XG5cdFx0XHRcdC8vIHJlc2V0IGNoYWluIGFjdGlvbnNcblx0XHRcdFx0YWN0aW9ucyA9IFtdO1xuXHRcdFx0fVxuXHRcdFx0Y29uc29sZS5sb2cobV9jaGFpbik7XG5cdFx0fSxcblxuXHRcdC8vIERpc3BsYXlzIHRoZSBvY2VhbiwgYW5kIHNoaXBzXG5cdFx0Ly8gVE9ETzogY2hlY2sgdGhlIGVkZ2UgY2FzZXMgd2l0aCB0aGUgbWFwIGVkZ2VzL3NpemVzXG5cdFx0cmVuZGVyOiAoc2hpcERhdGEpID0+IHtcblx0XHRcdHZhciBkb2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NlbmUnKTsgLy8gPGEtc2NlbmU+IHJlZmVyZW5jZVxuXG5cdFx0XHQvLyByZS1wb3NpdGlvbiBjYW1lcmE6IGNhbWVyYSBtdXN0IGJlIGFscmVhZHkgcHJlc2VudCB3aGVuIGh0bWwgbG9hZHNcblx0XHRcdHZhciBjYW1lcmEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FtZXJhJyk7XG5cdFx0XHRjYW1lcmEuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIG1fb2NlYW4ueCArIFwiIFwiICsgbV9vY2Vhbi55ICsgXCIgXCIgKyBtX29jZWFuLnopO1xuXHRcdFx0Y2FtZXJhLnNldEF0dHJpYnV0ZSgnY2FtZXJhJywgJ3VzZXJIZWlnaHQ6ICcgKyBtX0NvbnN0YW50cy5DYW1lcmFZT2Zmc2V0KTtcblx0XHRcdFxuXHRcdFx0Ly8gR2VuZXJhdGUgTWFwXG5cdFx0XHQvLyBUT0RPOiBQb3NzaWJsZSBlZGdlIGNhc2VzIHdpdGggdGhlIG1hcCBlZGdlIG5vdCBiZWluZyBiaWcgZW5vdWdoXG5cdFx0XHR2YXIgbWFwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1vY2VhbicpO1xuXG5cdFx0XHRtYXAuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIG1fb2NlYW4ueCArIFwiIFwiICsgbV9vY2Vhbi55ICsgXCIgXCIgKyBtX29jZWFuLnopO1xuXHRcdFx0bWFwLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCBTdHJpbmcobV9vY2Vhbi53aWR0aCkpO1xuXHRcdFx0bWFwLnNldEF0dHJpYnV0ZSgnZGVwdGgnLCBTdHJpbmcobV9vY2Vhbi5kZXB0aCkpO1xuXHRcdFx0bWFwLnNldEF0dHJpYnV0ZSgnZGVuc2l0eScsIFN0cmluZyhtX29jZWFuLmRlbnNpdHkpKTtcblx0XHRcdGRvYy5hcHBlbmRDaGlsZChtYXApO1xuXG5cdFx0XHQvLyBTcGF3biBTaGlwc1xuXHRcdFx0c2hpcERhdGEuZm9yRWFjaCgoZW50cnkpID0+IHtcblx0XHRcdFx0dmFyIHNoaXBIdWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcblx0XHRcdFx0dmFyIHNoaXBNb3VudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZW50aXR5Jyk7XG5cdFx0XHRcdHZhciBzaGlwQ2Fubm9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcblx0XHRcdFx0dmFyIG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWVudGl0eScpO1xuXHRcdFx0XHRcblx0XHRcdFx0bmFtZS5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgXCIwIDIgMFwiKTtcblx0XHRcdFx0bmFtZS5zZXRBdHRyaWJ1dGUoJ2xvb2stYXQnLCAnI2NhbWVyYScpO1xuXHRcdFx0XHRuYW1lLnNldEF0dHJpYnV0ZSgndGV4dC1nZW9tZXRyeScsIFwidmFsdWU6IFwiK2VudHJ5Lm5hbWUuc3Vic3RyaW5nKDAsIE1hdGgubWluKGVudHJ5Lm5hbWUubGVuZ3RoLCAyNCkpICsgXCI7IGZvbnQ6ICNwbGF5XCIpO1xuXHRcdFx0XHRuYW1lLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCAnY29sb3I6IGJsdWU7Jyk7XG5cblx0XHRcdFx0c2hpcEh1bGwuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIGVudHJ5LnggKyBcIiBcIiArIGVudHJ5LnkgKyBcIiBcIiArIGVudHJ5LnopO1xuXHRcdFx0XHRzaGlwSHVsbC5kYXRhc2V0LmlkID0gZW50cnkuaWQ7XG5cdFx0XHRcdHNoaXBIdWxsLmRhdGFzZXQubmFtZSA9IGVudHJ5Lm5hbWU7XG5cdFx0XHRcdHNoaXBIdWxsLmRhdGFzZXQub3duZXIgPSBlbnRyeS5vd25lcjtcblx0XHRcdFx0c2hpcEh1bGwuZGF0YXNldC54ID0gZW50cnkueDtcblx0XHRcdFx0c2hpcEh1bGwuZGF0YXNldC55ID0gZW50cnkueTtcblx0XHRcdFx0c2hpcEh1bGwuZGF0YXNldC56ID0gZW50cnkuejtcblx0XHRcdFx0c2hpcEh1bGwuZGF0YXNldC5oZWFsdGggPSBlbnRyeS5odWxsO1xuXHRcdFx0XHRzaGlwSHVsbC5kYXRhc2V0Lmh1bGwgPSBlbnRyeS5odWxsO1xuXHRcdFx0XHRzaGlwSHVsbC5kYXRhc2V0LmZpcmVwb3dlciA9IGVudHJ5LmZpcmVwb3dlcjtcblx0XHRcdFx0c2hpcEh1bGwuZGF0YXNldC5zcGVlZCA9IGVudHJ5LnNwZWVkO1xuXHRcdFx0XHRzaGlwSHVsbC5kYXRhc2V0LnJhbmdlID0gZW50cnkucmFuZ2U7XG5cdFx0XHRcdC8vIHNoaXBIdWxsLnNldEF0dHJpYnV0ZSgnc3JjJywgJyNTaGlwSHVsbCcpOyAvLyBmb3IgY29sbGFkYSBtb2RlbHNcblx0XHRcdFx0c2hpcEh1bGwuc2V0QXR0cmlidXRlKCdvYmotbW9kZWwnLCAnb2JqOiAjc2hpcEh1bGwnKTtcblx0XHRcdFx0c2hpcEh1bGwuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsICdjb2xvcjogJytlbnRyeS5jb2xvcisnOyBtZXRhbG5lc3M6IDAuNDsnKTtcblxuXHRcdFx0XHQvL3NoaXBNb3VudC5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywgJ2NvbG9yOiAnK2VudHJ5LmNvbG9yKyc7Jyk7XG5cdFx0XHRcdHNoaXBNb3VudC5zZXRBdHRyaWJ1dGUoJ29iai1tb2RlbCcsICdvYmo6ICNzaGlwTW91bnQnKTtcblx0XHRcdFx0c2hpcENhbm5vbi5zZXRBdHRyaWJ1dGUoJ29iai1tb2RlbCcsICdvYmo6ICNzaGlwQ2Fubm9uJyk7XG5cblxuXHRcdFx0XHRkb2MuYXBwZW5kQ2hpbGQoc2hpcEh1bGwpO1xuXHRcdFx0XHRzaGlwSHVsbC5hcHBlbmRDaGlsZChuYW1lKTtcblx0XHRcdFx0c2hpcEh1bGwuYXBwZW5kQ2hpbGQoc2hpcE1vdW50KTtcblx0XHRcdFx0c2hpcEh1bGwuYXBwZW5kQ2hpbGQoc2hpcENhbm5vbik7XG5cdFx0XHRcdG1fZW50aXR5W2VudHJ5LmlkXSA9IHNoaXBIdWxsO1xuXG5cdFx0XHR9KTtcblxuXHRcdH0sXG5cblx0XHRzaW5rU2hpcDogKGRhdGEpID0+IHtcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRcdHZhciBkb2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NlbmUnKTtcblx0XHRcdFx0dmFyIHRyYWNrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyYWNrJyk7XG5cdFx0XHRcdHZhciBzaGlwRG9tID0gbV9lbnRpdHlbZGF0YVswXS5pZF07XG5cblx0XHRcdFx0dmFyIGRlYnVnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1kcmF3LWN1cnZlJyk7XG5cdFx0XHRcdGRlYnVnLnNldEF0dHJpYnV0ZSgnY3VydmVyZWYnLCAnI3RyYWNrJyk7XG5cdFx0XHRcdGRlYnVnLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCAnc2hhZGVyOiBsaW5lOyBjb2xvcjogYmxhY2s7Jyk7XG5cdFx0XHRcdGRvYy5hcHBlbmRDaGlsZChkZWJ1Zyk7XG5cblx0XHRcdFx0dmFyIHBvaW50MSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtY3VydmUtcG9pbnQnKTtcblx0XHRcdFx0dmFyIHBvaW50MiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtY3VydmUtcG9pbnQnKTtcblx0XHRcdFx0cG9pbnQxLnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBkYXRhWzBdLnggKyBcIiBcIiArIGRhdGFbMF0ueSArIFwiIFwiICsgZGF0YVswXS56KTtcblx0XHRcdFx0cG9pbnQyLnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBkYXRhWzBdLnggKyBcIiBcIiArIChkYXRhWzBdLnktbV9Db25zdGFudHMuU2lua0Rpc3RhbmNlKSArIFwiIFwiICsgZGF0YVswXS56KTtcblx0XHRcdFx0dHJhY2suYXBwZW5kQ2hpbGQocG9pbnQxKTtcblx0XHRcdFx0dHJhY2suYXBwZW5kQ2hpbGQocG9pbnQyKTtcblxuXHRcdFx0XHRzaGlwRG9tLnNldEF0dHJpYnV0ZSgnYWxvbmdwYXRoJywgJ2N1cnZlOiAjdHJhY2s7IHJvdGF0ZTogdHJ1ZTsgY29uc3RyYWludDogMCAxIDA7IGRlbGF5OiAnK21fQ29uc3RhbnRzLldhaXRUaW1lQmV0d2VlbkFjdGlvbisnOyBkdXI6IDMwMDA7Jyk7XG5cblx0XHRcdFx0dmFyIGRvbmUgPSAoZXZlbnQpID0+IHtcblx0XHRcdFx0XHRzaGlwRG9tLnJlbW92ZUF0dHJpYnV0ZSgnYWxvbmdwYXRoJyk7XG5cdFx0XHRcdFx0aWYgKGRlYnVnLnBhcmVudE5vZGUpIHtcblx0XHRcdFx0XHRcdGRvYy5yZW1vdmVDaGlsZChkZWJ1Zyk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0d2hpbGUodHJhY2suaGFzQ2hpbGROb2RlcygpKSB7XG5cdFx0XHRcdFx0XHR0cmFjay5yZW1vdmVDaGlsZCh0cmFjay5jaGlsZE5vZGVzWzBdKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvL3NoaXBEb20ucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW92aW5nZW5kZWQnLCBkb25lKTtcblxuXHRcdFx0XHRcdGlmIChzaGlwRG9tLnBhcmVudE5vZGUpIHtcblx0XHRcdFx0XHRcdGRvYy5yZW1vdmVDaGlsZChzaGlwRG9tKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXNvbHZlKGV2ZW50KTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHRzaGlwRG9tLmFkZEV2ZW50TGlzdGVuZXIoJ21vdmluZ2VuZGVkJywgZG9uZSk7XG5cdFx0XHRcdC8vIHJlc29sdmUoKTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cblx0XHQvLyBEYXRhIHBhc3NlZCBpbiBhcmUgb25lIHNoaXBzIGFjdGlvbiBvZiBmaXJpbmcgYXQgb25lIGFuZCBvbmx5IG9uZSBjb29yZGluYXRlXG5cdFx0ZmlyZVNoaXA6IChkYXRhKSA9PiB7XG5cdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0XHR2YXIgZG9jID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjZW5lJyk7XG5cdFx0XHRcdHZhciB0cmFjayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0cmFjaycpO1xuXG5cdFx0XHRcdHZhciBidWxsZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLXNwaGVyZScpO1xuXHRcdFx0XHR2YXIgc291cmNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1jdXJ2ZS1wb2ludCcpO1xuXHRcdFx0XHR2YXIgYXJjID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1jdXJ2ZS1wb2ludCcpO1xuXHRcdFx0XHR2YXIgdGFyZ2V0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1jdXJ2ZS1wb2ludCcpO1xuXHRcdFx0XHRidWxsZXQuc2V0QXR0cmlidXRlKCdjb2xvcicsICdncmF5Jyk7XG5cdFx0XHRcdGJ1bGxldC5zZXRBdHRyaWJ1dGUoJ3JhZGl1cycsICcwLjEnKTtcblx0XHRcdFx0YnVsbGV0LnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBkYXRhWzBdLnggKyBcIiBcIiArIGRhdGFbMF0ueSArIFwiIFwiICsgZGF0YVswXS56KTtcblx0XHRcdFx0c291cmNlLnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBkYXRhWzBdLnggKyBcIiBcIiArIGRhdGFbMF0ueSArIFwiIFwiICsgZGF0YVswXS56KTtcblx0XHRcdFx0dGFyZ2V0LnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBkYXRhWzBdLmF0WCArIFwiIFwiICsgZGF0YVswXS5hdFkgKyBcIiBcIiArIGRhdGFbMF0uYXRaKTtcblx0XHRcdFx0YXJjLnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCAoZGF0YVswXS5hdFgrZGF0YVswXS54KS8yICsgXCIgXCIgKyAoKChkYXRhWzBdLmF0WStkYXRhWzBdLnkpLzIpK21fQ29uc3RhbnRzLkJ1bGxldEFyYykgKyBcIiBcIiArIChkYXRhWzBdLmF0WitkYXRhWzBdLnopLzIpO1xuXHRcdFx0XHR0cmFjay5hcHBlbmRDaGlsZChzb3VyY2UpO1xuXHRcdFx0XHR0cmFjay5hcHBlbmRDaGlsZChhcmMpO1xuXHRcdFx0XHR0cmFjay5hcHBlbmRDaGlsZCh0YXJnZXQpO1xuXG5cdFx0XHRcdHZhciBkZWJ1ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZHJhdy1jdXJ2ZScpO1xuXHRcdFx0XHRkZWJ1Zy5zZXRBdHRyaWJ1dGUoJ2N1cnZlcmVmJywgJyN0cmFjaycpO1xuXHRcdFx0XHRkZWJ1Zy5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywgJ3NoYWRlcjogbGluZTsgY29sb3I6IHJlZDsnKTtcblx0XHRcdFx0ZG9jLmFwcGVuZENoaWxkKGRlYnVnKTtcblxuXHRcdFx0XHR2YXIgdG1wID0gZG9jLmFwcGVuZENoaWxkKGJ1bGxldCk7XG5cdFx0XHRcdHRtcC5zZXRBdHRyaWJ1dGUoJ2Fsb25ncGF0aCcsICdjdXJ2ZTogI3RyYWNrOyByb3RhdGU6IHRydWU7IGNvbnN0YW50OiAwIDAgMTsgZGVsYXk6IDIwMDsgZHVyOiA1MDAnKTtcblxuXHRcdFx0XHR2YXIgZG9uZSA9IChldmVudCkgPT4ge1xuXHRcdFx0XHRcdHRtcC5yZW1vdmVBdHRyaWJ1dGUoJ2Fsb25ncGF0aCcpO1xuXHRcdFx0XHRcdGlmIChkZWJ1Zy5wYXJlbnROb2RlKSB7XG5cdFx0XHRcdFx0XHRkb2MucmVtb3ZlQ2hpbGQoZGVidWcpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR3aGlsZSh0cmFjay5oYXNDaGlsZE5vZGVzKCkpIHtcblx0XHRcdFx0XHRcdHRyYWNrLnJlbW92ZUNoaWxkKHRyYWNrLmNoaWxkTm9kZXNbMF0pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vdG1wLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdmluZ2VuZGVkJywgZG9uZSk7XG5cdFx0XHRcdFx0aWYgKHRtcC5wYXJlbnROb2RlKSB7XG5cdFx0XHRcdFx0XHRkb2MucmVtb3ZlQ2hpbGQodG1wKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXNvbHZlKGV2ZW50KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRtcC5hZGRFdmVudExpc3RlbmVyKCdtb3ZpbmdlbmRlZCcsIGRvbmUpO1xuXHRcdFx0XHQvL3Jlc29sdmUoKTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cblx0XHQvLyBEYXRhIHBhc3NlZCBpbiBtdXN0IGJlIGZvciBtb3ZlbWVudCBvZiBvbmUgc2hpcFxuXHRcdG1vdmVTaGlwOiAoZGF0YSkgPT4ge1xuXHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblxuXHRcdFx0XHR2YXIgc2hpcERvbSA9IG1fZW50aXR5W2RhdGFbMF0uaWRdOyAvLyBodG1sIGVsZW1lbnRcblx0XHRcdFx0Ly8gaWYgc3RhdGVtZW50IGlzIG5vdCB3b3JraW5nXG5cdFx0XHRcdC8vIGlmIChkYXRhLmxlbmd0aCA9PT0gMSAmJiBkYXRhWzBdLnggPT09IHNoaXBEb20uZGF0YXNldC54ICYmIGRhdGFbMF0ueiA9PT0gc2hpcERvbS5kYXRhc2V0LnopIHtcblx0XHRcdFx0Ly8gICAgIC8vIGlmIHNoaXBEb20gdHJpZXMgdG8gbW92ZSBhZ2FpbnN0IGVkZ2Ugb3Igb2NjdXBpZWQgcGxhY2Vcblx0XHRcdFx0Ly8gICAgIGFsZXJ0KFwiU2tpcHBlZFwiKTtcblx0XHRcdFx0Ly8gICAgIHJlc29sdmUoXCJTa2lwcGVkXCIpO1xuXHRcdFx0XHQvLyB9XG5cblx0XHRcdFx0dmFyIGRvYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2VuZScpOyAvLyA8YS1zY2VuZT4gcmVmZXJlbmNlXG5cdFx0XHRcdHZhciB0cmFjayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0cmFjaycpO1xuXHRcdFx0XHQvL3ZhciBzdGFydENvb3JkID0ge1wieFwiOiBkYXRhWzBdLnh9O1xuXG5cdFx0XHRcdHZhciBkZWJ1ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZHJhdy1jdXJ2ZScpO1xuXHRcdFx0XHRkZWJ1Zy5zZXRBdHRyaWJ1dGUoJ2N1cnZlcmVmJywgJyN0cmFjaycpO1xuXHRcdFx0XHRkZWJ1Zy5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywgJ3NoYWRlcjogbGluZTsgY29sb3I6IGJsdWU7Jyk7XG5cdFx0XHRcdGRvYy5hcHBlbmRDaGlsZChkZWJ1Zyk7XG5cblx0XHRcdFx0Ly8gYWRkIGN1cnJlbnQgbG9jYXRpb24gYXMgYSBzdGFydGluZyBwb2ludCBvZiB0aGUgY3VydmVcblx0XHRcdFx0dmFyIHBvaW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1jdXJ2ZS1wb2ludCcpO1xuXHRcdFx0XHRwb2ludC5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgU3RyaW5nKHNoaXBEb20uZGF0YXNldC54ICsgXCIgXCIgKyBzaGlwRG9tLmRhdGFzZXQueSArIFwiIFwiICsgc2hpcERvbS5kYXRhc2V0LnopKTtcblx0XHRcdFx0dHJhY2suYXBwZW5kQ2hpbGQocG9pbnQpO1xuXHRcdFx0XHQvLyBhZGQgY2hhaW4tYWJsZSBnb2FsIGxvY2F0aW9ucyB0byB0aGUgY3VydmVcblx0XHRcdFx0dmFyIHByZXZpb3VzID0geyd4Jzogc2hpcERvbS5kYXRhc2V0LngsICd6Jzogc2hpcERvbS5kYXRhc2V0Lnp9O1xuXHRcdFx0XHR2YXIgeERpc3RhbmNlID0gMDtcblx0XHRcdFx0dmFyIHpEaXN0YW5jZSA9IDA7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiTW92aW5nOiBcIiwgZGF0YSk7XG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdHBvaW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1jdXJ2ZS1wb2ludCcpO1xuXHRcdFx0XHRcdHBvaW50LnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBkYXRhW2ldLnggKyBcIiBcIiArIGRhdGFbaV0ueSArIFwiIFwiICsgZGF0YVtpXS56KTtcblx0XHRcdFx0XHR4RGlzdGFuY2UgKz0gTWF0aC5hYnMoZGF0YVtpXS54IC0gcHJldmlvdXMueCk7XG5cdFx0XHRcdFx0ekRpc3RhbmNlICs9IE1hdGguYWJzKGRhdGFbaV0ueiAtIHByZXZpb3VzLnopO1xuXHRcdFx0XHRcdGlmIChpICsgMSA8IGRhdGEubGVuZ3RoICYmIGRhdGFbaV0ueCA9PT0gZGF0YVtpKzFdLnggJiYgZGF0YVtpXS56ID09PSBkYXRhW2krMV0ueikge1xuXHRcdFx0XHRcdFx0aSsrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR0cmFjay5hcHBlbmRDaGlsZChwb2ludCk7XG5cdFx0XHRcdFx0cHJldmlvdXMgPSB7J3gnOiBkYXRhW2ldLngsICd6JzogZGF0YVtpXS56fTtcblx0XHRcdFx0fVxuXHRcdFx0XHR2YXIgZHVyID0gKHhEaXN0YW5jZSt6RGlzdGFuY2UpKm1fQ29uc3RhbnRzLldhaXRUaW1lUGVyVGlsZU1vdmVkO1xuXHRcdFx0XHRzaGlwRG9tLnNldEF0dHJpYnV0ZSgnYWxvbmdwYXRoJywgJ2N1cnZlOiAjdHJhY2s7IHJvdGF0ZTogdHJ1ZTsgY29uc3RyYWludDogMCAwIDE7IGRlbGF5OiAnK21fQ29uc3RhbnRzLldhaXRUaW1lQmV0d2VlbkFjdGlvbisnOyBkdXI6ICcrZHVyKyc7Jyk7XG5cblx0XHRcdFx0dmFyIGRvbmUgPSAoZXZlbnQpID0+IHtcblx0XHRcdFx0XHQvLyB2YXIgbGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeVRhZ05hbWUoJ2EtZHJhdy1jdXJ2ZScpO1xuXHRcdFx0XHRcdC8vIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdC8vICAgICBsaXN0WzBdLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobGlzdFswXSk7XG5cdFx0XHRcdFx0Ly8gfVxuXHRcdFx0XHRcdGlmIChkZWJ1Zy5wYXJlbnROb2RlKSB7XG5cdFx0XHRcdFx0XHRkb2MucmVtb3ZlQ2hpbGQoZGVidWcpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHdoaWxlKHRyYWNrLmhhc0NoaWxkTm9kZXMoKSkge1xuXHRcdFx0XHRcdFx0dHJhY2sucmVtb3ZlQ2hpbGQodHJhY2suY2hpbGROb2Rlc1swXSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHNoaXBEb20ucmVtb3ZlQXR0cmlidXRlKCdhbG9uZ3BhdGgnKTtcblx0XHRcdFx0XHRzaGlwRG9tLmRhdGFzZXQueCA9IGRhdGFbZGF0YS5sZW5ndGgtMV0ueDtcblx0XHRcdFx0XHRzaGlwRG9tLmRhdGFzZXQueiA9IGRhdGFbZGF0YS5sZW5ndGgtMV0uejtcblx0XHRcdFx0XHRzaGlwRG9tLmRhdGFzZXQueSA9IGRhdGFbZGF0YS5sZW5ndGgtMV0ueTtcblxuXHRcdFx0XHRcdC8vc2hpcERvbS5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3ZpbmdlbmRlZCcsIGRvbmUpO1xuXHRcdFx0XHRcdHJlc29sdmUoZXZlbnQpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHNoaXBEb20uYWRkRXZlbnRMaXN0ZW5lcignbW92aW5nZW5kZWQnLCBkb25lKTtcblxuXHRcdFx0XHRcblx0XHRcdH0pO1xuXHRcdH0sXG5cblx0XHRzaW11bGF0ZTogKCkgPT4ge1xuXHRcdFx0Y29uc29sZS5sb2coXCJjaGFpbjogXCIsIG1fY2hhaW4pO1xuXHRcdFx0dmFyIG5vdFN0b3AgPSB0cnVlO1xuXHRcdFx0aWYgKG1fY2hhaW4ubGVuZ3RoID09IDApIHtcblx0XHRcdFx0bm90U3RvcCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0dmFyIGN1cnJlbnQgPSBtX2NoYWluLnNoaWZ0KCk7IC8vIGRvbid0IHNoaWZ0IHdoZW4gbGVuZ3RoIGlzIHplcm9cblx0XHRcdGlmIChjdXJyZW50ICYmIG5vdFN0b3ApIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJjdXJyZW50OiBcIiwgY3VycmVudCk7XG5cdFx0XHRcdHN3aXRjaChjdXJyZW50LnR5cGUpIHtcblx0XHRcdFx0XHRjYXNlIFwiTU9WRVwiOlxuXHRcdFx0XHRcdFx0YXBwLm1vdmVTaGlwKGN1cnJlbnQuYWN0aW9ucykudGhlbigoZG9uZSkgPT4ge1xuXHRcdFx0XHRcdFx0XHQvL2FsZXJ0KFwiTW92ZWQgXCIgKyBtX2NoYWluLmxlbmd0aCArIFwiIGFjdGlvbnMgbGVmdFwiKTtcblx0XHRcdFx0XHRcdFx0YXBwLnNpbXVsYXRlKCk7XG5cdFx0XHRcdFx0XHR9KS5jYXRjaCgoZXJyKSA9PiB7XG5cdFx0XHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSBcIkZJUkVcIjpcblx0XHRcdFx0XHRcdGFwcC5maXJlU2hpcChjdXJyZW50LmFjdGlvbnMpLnRoZW4oKGRvbmUpID0+IHtcblx0XHRcdFx0XHRcdFx0Ly9hbGVydChcIkZpcmVkIFwiICsgbV9jaGFpbi5sZW5ndGggKyBcIiBhY3Rpb25zIGxlZnRcIik7XG5cdFx0XHRcdFx0XHRcdGFwcC5zaW11bGF0ZSgpO1xuXHRcdFx0XHRcdFx0fSkuY2F0Y2goKGVycikgPT4ge1xuXHRcdFx0XHRcdFx0XHRjb25zb2xlLmVycm9yKGVycik7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgXCJTSU5LXCI6XG5cdFx0XHRcdFx0XHRhcHAuc2lua1NoaXAoY3VycmVudC5hY3Rpb25zKS50aGVuKChkb25lKSA9PiB7XG5cdFx0XHRcdFx0XHRcdC8vYWxlcnQoXCJTdW5rIFwiKyBtX2NoYWluLmxlbmd0aCArIFwiIGFjdGlvbnMgbGVmdFwiKTtcblx0XHRcdFx0XHRcdFx0YXBwLnNpbXVsYXRlKCk7XG5cdFx0XHRcdFx0XHR9KS5jYXRjaCgoZXJyKSA9PiB7XG5cdFx0XHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiVW5rbm93biBBY3Rpb24gVHlwZSBcIiArIGN1cnJlbnQudHlwZSArIFwiIGluIHNpbXVsYXRlIGZ1bmN0aW9uXCIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRhbGVydChcIlNpbXVsYXRpb24gRG9uZVwiKTtcblx0XHRcdFx0fSwgMTAwMDApO1xuXHRcdFx0fVxuXG5cdFx0fSxcblxuXHRcdC8qKiB0cmFuc2xhdGVzIHRoZSBjb29yZGluYXRlIGluIHRoZSBqYXZhIGdhbWUgdG8gdGhpcyBzY2VuZSdzIGNvb3JkaW5hdGVcblx0XHRcdEphdmEgR2FtZTogRWFjaCBzaGlwIHNwYW5zIG9uZSAoeCwgeSkgdW5pdFxuXHRcdFx0SmF2YSBHYW1lOiBDb29yZGluYXRlIHN5c3RlbSBoYXMgKDAsIDApIGF0IHRvcCBsZWZ0IGNvcm5lciAod2l0aG91dCBuZWdhdGl2ZXMpXG5cdFx0XHRBRnJhbWUgU2NlbmU6IEVhY2ggc2hpcCBtb2RlbCBpcyBhIDR4NCBib3hcblx0XHRcdEFGcmFtZSBTY2VuZTogQ29vcmRpbmF0ZSBzeXN0ZW0gaXMgKDAsIDApIGF0IHRoZSBjZW50ZXIgKHdpdGggbmVnYXRpdmVzKVxuXHRcdCovXG5cdFx0Z2V0U3RyQ29vcmQ6IChjb29yZCwgb2Zmc2V0WSkgPT4ge1xuXHRcdFx0cmV0dXJuIChtX29jZWFuLngtY29vcmQueCkqNCArIFwiIFwiICsgb2Zmc2V0WSArIFwiIFwiICsgKG1fb2NlYW4ueS1jb29yZC55KSo0O1xuXHRcdH0sXG5cblx0XHRnZXRTaGlwczogKCkgPT4ge1xuXHRcdFx0cmV0dXJuIG1fc2hpcHM7XG5cdFx0fSxcblxuXHRcdGdldE9jZWFuOiAoKSA9PiB7XG5cdFx0XHRyZXR1cm4gbV9vY2Vhbjtcblx0XHR9XG5cblxuXHR9XG5cblx0cmV0dXJuIGFwcDtcbn1cblxudmFyIGFwcCA9IGJhdHRsZXNoaXAoKTtcbmFwcC5pbml0KCk7XG5cbi8vIHZhciBCQVRUTEVfU0VSVkVSX1VSTCA9ICdodHRwczovL2JhdHRsZXNoaXAtdmluZ2thbi5jOXVzZXJzLmlvLzF2MT9wMT1lc2kxNy5jcy5EZXN0cm95ZXJTaGlwJnAyPWVzaTE3LmhsaTEwOS5GbG9hdGVyJzsvLyArIE1hdGguY2VpbChNYXRoLnJhbmRvbSgpICogMTAwKTtcblxuLy8gJC5nZXQoQkFUVExFX1NFUlZFUl9VUkwpLnRoZW4oZGF0YSA9PiB7XG4vLyBcdGlucHV0ID0gZGF0YTtcbi8vIFx0YXBwLmluaXQoKTtcbi8vIH0pLmRvbmUoKCkgPT4ge1xuLy8gXHRjb25zb2xlLmxvZyhcIkRhdGEgc3VjY2Vzc2Z1bGx5IHJldHJpZXZlZCBmcm9tIHNlcnZlclwiKTtcbi8vIH0pLmZhaWwoKCkgPT4ge1xuLy8gXHRjb25zb2xlLmxvZyhcIlVuYWJsZSB0byByZXRyaWV2ZSBkYXRhLCBzdGFydGluZyB3aXRoIGxvY2FsIGRhdGFcIik7XG4vLyBcdGFwcC5pbml0KCk7XG4vLyB9KTtcblxuXG5cblxuXG5cbiJdfQ==\n"]}