{"version":3,"sources":["main.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","db","firebase","initializeApp","database","app","m_ocean","m_Constants","CameraYOffset","OceanYOffset","OceanPadding","ShipYOffset","SinkDistance","BulletArc","WaitTimePerTileMoved","WaitTimeBetweenAction","m_input","m_ships","m_chain","m_entity","init","ships","input","turns","ocean","map","preprocess","doc","document","getElementById","track","createElement","setAttribute","appendChild","render","vex","dialog","confirm","message","buttons","$","extend","YES","className","text","callback","doIt","setTimeout","simulate","data","translate","d","res","hasOwnProperty","atX","atY","x","z","y","actions","index","Math","floor","width","depth","density","forEach","entry","push","chain","id","type","shipData","camera","String","spawnShip","ship","dataset","name","owner","health","hull","firepower","speed","range","heart","parseInt","color","shipInstance","sinkShip","Promise","resolve","reject","shipDom","debug","point1","point2","addEventListener","event","removeAttribute","parentNode","removeChild","hasChildNodes","childNodes","fireShip","bullet","source","arc","target","atZ","tmp","distance","sqrt","aimShip","getAttribute","hitShip","moveShip","point","previous","xDistance","zDistance","abs","direction","dur","notStop","current","shift","then","done","catch","err","console","error","log","warn","alert","getStrCoord","coord","offsetY","getShips","getOcean","battleship","params","qs","split","join","tokens","re","exec","decodeURIComponent","getQueryParams","location","search","getDataFromCode","ref","once","snapshot","gameData","val","getCode","prompt","value"],"mappings":"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","file":"../main.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\"use strict\";\n\n// Initialize Firebase\nvar config = {\n\tapiKey: \"AIzaSyA9EYUXVL5WAh6Aam1qXlWyvi3b7HLcZ1U\",\n\tauthDomain: \"esigamma.firebaseapp.com\",\n\tdatabaseURL: \"https://esigamma.firebaseio.com\",\n\tprojectId: \"esigamma\",\n\tstorageBucket: \"esigamma.appspot.com\",\n\tmessagingSenderId: \"734163636039\"\n};\nvar FirebaseInstance = firebase.initializeApp(config, \"Davy Jones' Locker\");\n\nvar db = FirebaseInstance.database();\n\nfunction getQueryParams(qs) {\n\tqs = qs.split('+').join(' ');\n\tvar params = {},\n\t    tokens,\n\t    re = /[?&]?([^=]+)=([^&]*)/g;\n\twhile (tokens = re.exec(qs)) {\n\t\tparams[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);\n\t}\n\treturn params;\n}\n\nfunction battleship() {\n\n\t// private\n\tvar m_Constants = {\n\t\tCameraYOffset: 25,\n\t\tOceanYOffset: 0,\n\t\tOceanPadding: 10,\n\t\tShipYOffset: 0,\n\t\tSinkDistance: 5,\n\t\tBulletArc: 2,\n\t\tWaitTimePerTileMoved: 300,\n\t\tWaitTimeBetweenAction: 50 // in miliseconds\n\t};\n\n\tvar m_input = {};\n\n\tvar m_ships = []; // stores formatted json of ship initialization\n\tvar m_chain = []; // stores chainable actions in a turn\n\tvar m_entity = {}; // object with id to html dom element of ships\n\n\tvar m_test = 0;\n\n\tvar m_ocean;\n\n\t// public\n\tvar app = {\n\n\t\tinit: function init() {\n\t\t\t// default access of data when there are no connectivity\n\t\t\tm_input = { \"ships\": input.init.ships, \"turns\": input.turns, \"ocean\": input.init.map };\n\t\t\tapp.preprocess(m_input);\n\n\t\t\tvar doc = document.getElementById('scene');\n\t\t\tvar track = document.createElement('a-curve');\n\t\t\ttrack.setAttribute('id', 'track');\n\t\t\ttrack.setAttribute('type', 'Line');\n\t\t\tdoc.appendChild(track);\n\n\t\t\tapp.render(m_ships);\n\n\t\t\t/*setTimeout(() => {\n   \tapp.simulate();\n   }, 10000);*/\n\t\t\tvex.dialog.confirm({\n\t\t\t\tmessage: 'Ready to view the battle?',\n\t\t\t\tbuttons: [$.extend({}, vex.dialog.buttons.YES, {\n\t\t\t\t\tclassName: 'vex-dialog-button-primary',\n\t\t\t\t\ttext: 'Play'\n\t\t\t\t})],\n\t\t\t\tcallback: function callback(doIt) {\n\t\t\t\t\tif (doIt) {\n\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\tapp.simulate();\n\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t// call function to wait a bit before starting simulation\n\t\t\t//app.simulate();\n\t\t},\n\n\t\tpreprocess: function preprocess(data) {\n\t\t\tvar translate = function translate(d) {\n\t\t\t\tvar res = d;\n\t\t\t\tif (res.hasOwnProperty(\"atX\") && res.hasOwnProperty(\"atY\")) {\n\t\t\t\t\tres['atX'] = 4 * d.atX;\n\t\t\t\t\tres['atZ'] = 4 * d.atY; // make sure to move the y property before overriding it\n\t\t\t\t\tres['atY'] = m_Constants.ShipYOffset;\n\t\t\t\t}\n\t\t\t\tres.x = 4 * d.x;\n\t\t\t\tres.z = 4 * d.y; // make sure to move the y property before overriding it\n\t\t\t\tres.y = m_Constants.ShipYOffset;\n\t\t\t\treturn res;\n\t\t\t};\n\t\t\tvar actions = [];\n\t\t\tvar index = 0;\n\n\t\t\t// preprocess initial map information\n\t\t\t// m_ocean = { \"x\": ((4*Math.floor(data.ocean.x/2))-2) + (m_Constants.OceanPadding/2),\n\t\t\t//             \"y\": m_Constants.OceanYOffset, \n\t\t\t//             \"z\": ((4*Math.floor(data.ocean.y/2))) + (m_Constants.OceanPadding/2), \n\t\t\t//             \"width\": (4*data.ocean.x)+m_Constants.OceanPadding, \n\t\t\t//             \"depth\": (4*data.ocean.y)+m_Constants.OceanPadding, \n\t\t\t//             \"density\": Math.min(3*data.ocean.x, 3*data.ocean.y)+m_Constants.OceanPadding\n\t\t\t//         };\n\t\t\tm_ocean = { \"x\": 4 * Math.floor(data.ocean.x / 2) - 2,\n\t\t\t\t\"y\": m_Constants.OceanYOffset,\n\t\t\t\t\"z\": 4 * Math.floor(data.ocean.y / 2),\n\t\t\t\t\"width\": 400,\n\t\t\t\t\"depth\": 400,\n\t\t\t\t\"density\": 240\n\t\t\t};\n\n\t\t\t// preprocess initial ship information\n\t\t\tdata.ships.forEach(function (entry) {\n\t\t\t\tm_ships.push(translate(entry));\n\t\t\t});\n\n\t\t\t// preprocess actions and turns information\n\t\t\twhile (index < data.turns.length) {\n\t\t\t\tvar chain = true;\n\t\t\t\twhile (chain) {\n\t\t\t\t\tif (index === data.turns.length) break;\n\n\t\t\t\t\tif (actions.length === 0) {\n\t\t\t\t\t\tactions.push(translate(data.turns[index]));\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}\n\t\t\t\t\t// Ship id and action type has to be the same to be considered a chain-able action\n\t\t\t\t\telse if (actions[0].id === data.turns[index].id && actions[0].type === data.turns[index].type) {\n\t\t\t\t\t\t\tif (actions[0].type === \"MOVE\") {\n\t\t\t\t\t\t\t\tactions.push(translate(data.turns[index]));\n\t\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Firing must be at the same coordinates to be considered a chain-able action\n\t\t\t\t\t\t\telse if (actions[0].type === \"FIRE\" && actions[0].atX === 4 * data.turns[index].atX && actions[0].atY === 4 * data.turns[index].atY) {\n\t\t\t\t\t\t\t\t\tactions.push(translate(data.turns[index]));\n\t\t\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t\t\t} else if (actions[0].type === \"SINK\") {\n\t\t\t\t\t\t\t\t\tactions.push(translate(data.turns[index]));\n\t\t\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tchain = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tchain = false;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// add action chain to variable\n\t\t\t\tm_chain.push({ \"type\": actions[0].type, \"actions\": actions });\n\t\t\t\t// reset chain actions\n\t\t\t\tactions = [];\n\t\t\t}\n\t\t},\n\n\t\t// Displays the ocean, and ships\n\t\t// TODO: check the edge cases with the map edges/sizes\n\t\trender: function render(shipData) {\n\t\t\tvar doc = document.getElementById('scene'); // <a-scene> reference\n\n\t\t\t// re-position camera: camera must be already present when html loads\n\t\t\tvar camera = document.getElementById('camera');\n\t\t\t//camera.setAttribute('position', m_ocean.x + \" \" + m_ocean.y + \" \" + m_ocean.z);\n\t\t\tcamera.setAttribute('position', m_ocean.x + \" \" + m_ocean.y + \" \" + (m_ocean.z + 1.5 * m_ocean.x));\n\t\t\tcamera.setAttribute('camera', 'userHeight: ' + m_Constants.CameraYOffset);\n\t\t\t//camera.setAttribute('rotation', -Math.atan(m_Constants.CameraYOffset/(m_ocean.z+m_ocean.x))); // TODO: check if the string is a vec3\n\t\t\tcamera.setAttribute('rotation', '-50 0 0');\n\n\t\t\t// Generate Map\n\t\t\t// TODO: Possible edge cases with the map edge not being big enough\n\t\t\tvar map = document.createElement('a-ocean');\n\n\t\t\tmap.setAttribute('position', m_ocean.x + \" \" + m_ocean.y + \" \" + m_ocean.z);\n\t\t\tmap.setAttribute('width', String(m_ocean.width));\n\t\t\tmap.setAttribute('depth', String(m_ocean.depth));\n\t\t\tmap.setAttribute('density', String(m_ocean.density));\n\t\t\tdoc.appendChild(map);\n\n\t\t\tvar spawnShip = function spawnShip(entry) {\n\t\t\t\tvar ship = document.createElement('a-entity');\n\n\t\t\t\tship.dataset.id = entry.id;\n\t\t\t\tship.dataset.name = entry.name;\n\t\t\t\tship.dataset.owner = entry.owner;\n\t\t\t\tship.dataset.x = entry.x;\n\t\t\t\tship.dataset.y = entry.y;\n\t\t\t\tship.dataset.z = entry.z;\n\t\t\t\tship.dataset.health = entry.hull;\n\t\t\t\tship.dataset.hull = entry.hull;\n\t\t\t\tship.dataset.firepower = entry.firepower;\n\t\t\t\tship.dataset.speed = entry.speed;\n\t\t\t\tship.dataset.range = entry.range;\n\n\t\t\t\tvar heart = \"\";\n\t\t\t\tfor (var i = 0; i < parseInt(entry.hull); i++) {\n\t\t\t\t\theart += \" •\";\n\t\t\t\t}\n\n\t\t\t\tship.setAttribute('position', entry.x + \" \" + entry.y + \" \" + entry.z);\n\n\t\t\t\tif (entry.color === \"rgb(255, 255, 0)\") {\n\t\t\t\t\tship.setAttribute('template', 'src: #submarine-template');\n\t\t\t\t\tship.setAttribute('class', 'submarine');\n\t\t\t\t} else {\n\t\t\t\t\tship.setAttribute('template', 'src: #boat-template');\n\t\t\t\t\tship.setAttribute('class', 'boat');\n\t\t\t\t}\n\n\t\t\t\t// ${variable} <- variable name be lower case\n\t\t\t\tship.setAttribute('data-ship_color', 'color: ' + entry.color + '; metalness: 0.4;');\n\t\t\t\tship.setAttribute('data-ship_name', 'value: ' + entry.name + '; font: #play;');\n\t\t\t\tship.setAttribute('data-ship_health', 'value: ' + heart + ';');\n\n\t\t\t\tvar shipInstance = doc.appendChild(ship);\n\t\t\t\tm_entity[entry.id] = shipInstance;\n\t\t\t};\n\t\t\t// spawn the ships!\n\t\t\tshipData.forEach(function (entry) {\n\t\t\t\tspawnShip(entry);\n\t\t\t});\n\t\t},\n\n\t\tsinkShip: function sinkShip(data) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tvar doc = document.getElementById('scene');\n\t\t\t\tvar track = document.getElementById('track');\n\t\t\t\tvar shipDom = m_entity[data[0].id];\n\n\t\t\t\tvar debug = document.createElement('a-draw-curve');\n\t\t\t\tdebug.setAttribute('curveref', '#track');\n\t\t\t\tdebug.setAttribute('material', 'shader: line; color: black;');\n\t\t\t\tdoc.appendChild(debug);\n\n\t\t\t\tvar point1 = document.createElement('a-curve-point');\n\t\t\t\tvar point2 = document.createElement('a-curve-point');\n\t\t\t\tpoint1.setAttribute('position', data[0].x + \" \" + data[0].y + \" \" + data[0].z);\n\t\t\t\tpoint2.setAttribute('position', data[0].x + \" \" + (data[0].y - m_Constants.SinkDistance) + \" \" + data[0].z);\n\t\t\t\ttrack.appendChild(point1);\n\t\t\t\ttrack.appendChild(point2);\n\n\t\t\t\tshipDom.setAttribute('alongpath', 'curve: #track; rotate: false; delay: ' + m_Constants.WaitTimeBetweenAction + '; dur: 1000;');\n\n\t\t\t\tvar done = function done(event) {\n\t\t\t\t\tshipDom.removeAttribute('alongpath');\n\t\t\t\t\tif (debug.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(debug);\n\t\t\t\t\t}\n\n\t\t\t\t\twhile (track.hasChildNodes()) {\n\t\t\t\t\t\ttrack.removeChild(track.childNodes[0]);\n\t\t\t\t\t}\n\n\t\t\t\t\t//shipDom.removeEventListener('movingended', done);\n\n\t\t\t\t\tif (shipDom.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(shipDom);\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(event);\n\t\t\t\t};\n\n\t\t\t\tshipDom.addEventListener('movingended', done);\n\t\t\t\t// resolve();\n\t\t\t});\n\t\t},\n\n\t\t// Data passed in are one ships action of firing at one and only one coordinate\n\t\tfireShip: function fireShip(data) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tvar doc = document.getElementById('scene');\n\t\t\t\tvar track = document.getElementById('track');\n\t\t\t\tvar ship = m_entity[data[0].id];\n\n\t\t\t\tvar bullet = document.createElement('a-sphere');\n\t\t\t\tvar source = document.createElement('a-curve-point');\n\t\t\t\tvar arc = document.createElement('a-curve-point');\n\t\t\t\tvar target = document.createElement('a-curve-point');\n\n\t\t\t\t// var saves = null;\n\t\t\t\t// if (ship.className === \"submarine\") {\n\t\t\t\t// \tfor (var i = 0; i < ship.childNodes.length; i++) {\n\t\t\t\t// \t\tif (ship.childNodes[i].className === \"submarineMissile\") {\n\t\t\t\t// \t\t\tbullet = ship.childNodes[i]\n\t\t\t\t// \t\t\tsaves = bullet.getAttribute('position');\n\t\t\t\t// \t\t\tbreak;\n\t\t\t\t// \t\t}\n\t\t\t\t// \t}\n\t\t\t\t// \tconsole.log('missile start', saves);\n\t\t\t\t// \tsource.setAttribute('position', (data[0].x+saves.x) + \" \" + (data[0].y+saves.y) + \" \" + (data[0].z+saves.z));\n\t\t\t\t// \tarc.setAttribute('position', (data[0].x+saves.x) + \" \" + (data[0].y+saves.y+5) + \" \" + (data[0].z+saves.z));\n\t\t\t\t// \ttarget.setAttribute('position', data[0].atX + \" \" + data[0].atY + \" \" + data[0].atZ);\n\t\t\t\t// \ttrack.appendChild(source);\n\t\t\t\t// \ttrack.appendChild(arc);\n\t\t\t\t// \ttrack.appendChild(target);\n\t\t\t\t// }\n\t\t\t\t// else {\n\t\t\t\tbullet.setAttribute('color', 'gray');\n\t\t\t\tbullet.setAttribute('radius', '0.2');\n\t\t\t\tbullet.setAttribute('position', data[0].x + \" \" + data[0].y + \" \" + data[0].z);\n\t\t\t\tsource.setAttribute('position', data[0].x + \" \" + data[0].y + \" \" + data[0].z);\n\t\t\t\tarc.setAttribute('position', (data[0].atX + data[0].x) / 2 + \" \" + ((data[0].atY + data[0].y) / 2 + m_Constants.BulletArc) + \" \" + (data[0].atZ + data[0].z) / 2);\n\t\t\t\ttarget.setAttribute('position', data[0].atX + \" \" + data[0].atY + \" \" + data[0].atZ);\n\t\t\t\ttrack.appendChild(source);\n\t\t\t\ttrack.appendChild(arc);\n\t\t\t\ttrack.appendChild(target);\n\t\t\t\t// }\n\n\t\t\t\tvar debug = document.createElement('a-draw-curve');\n\t\t\t\tdebug.setAttribute('curveref', '#track');\n\t\t\t\tdebug.setAttribute('material', 'shader: line; color: red;');\n\t\t\t\tdoc.appendChild(debug);\n\n\t\t\t\tvar tmp = doc.appendChild(bullet);\n\t\t\t\tvar distance = Math.sqrt((data[0].atX - data[0].x) * (data[0].atX - data[0].x) + (data[0].atZ - data[0].z) * (data[0].atZ - data[0].z)) + m_Constants.BulletArc * m_Constants.BulletArc;\n\t\t\t\t//console.log(\"distance: \", distance);\n\t\t\t\ttmp.setAttribute('alongpath', 'curve: #track; rotate: true; constant: 0 -1 0; delay: 100; dur: ' + 25 * distance);\n\n\t\t\t\tvar done = function done(event) {\n\t\t\t\t\ttmp.removeAttribute('alongpath');\n\t\t\t\t\tif (debug.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(debug);\n\t\t\t\t\t}\n\t\t\t\t\twhile (track.hasChildNodes()) {\n\t\t\t\t\t\ttrack.removeChild(track.childNodes[0]);\n\t\t\t\t\t}\n\n\t\t\t\t\t//tmp.removeEventListener('movingended', done);\n\t\t\t\t\tif (tmp.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(tmp);\n\t\t\t\t\t}\n\t\t\t\t\t// if (ship.className === \"submarine\") {\n\t\t\t\t\t// \tvar reload = document.createElement('a-entity');\n\t\t\t\t\t// \treload.setAttribute('class', 'submarineMissile');\n\t\t\t\t\t// \treload.setAttribute('obj-model', 'obj: #submarineMissile');\n\t\t\t\t\t// \treload.setAttribute('position', saves);\n\t\t\t\t\t// \tship.appendChild(reload);\n\t\t\t\t\t// }\n\n\t\t\t\t\tresolve(event);\n\t\t\t\t};\n\n\t\t\t\ttmp.addEventListener('movingended', done);\n\t\t\t\t//resolve();\n\t\t\t});\n\t\t},\n\n\t\taimShip: function aimShip(data) {\n\t\t\tvar rotateVector = function rotateVector(vec2, deg) {\n\t\t\t\tvar rad = -deg * Math.PI / 180;\n\t\t\t\tvar cos = Math.cos(rad);\n\t\t\t\tvar sin = Math.sin(rad);\n\t\t\t\t//console.log(\"vector: \", vec2);\n\t\t\t\t//console.log(\"degree: \", deg);\n\t\t\t\t// round the numbers\n\t\t\t\treturn {\n\t\t\t\t\t\"x\": Math.round(100000 * ((vec2.x - vec2.atX) * cos - (vec2.z - vec2.atZ) * sin)) / 100000,\n\t\t\t\t\t\"y\": vec2.y - vec2.atY,\n\t\t\t\t\t\"z\": Math.round(100000 * ((vec2.x - vec2.atX) * sin + (vec2.z - vec2.atZ) * cos)) / 100000\n\t\t\t\t};\n\t\t\t};\n\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\t//console.log('aim info: ', data);\n\t\t\t\tvar doc = document.getElementById('scene');\n\t\t\t\tvar track = document.getElementById('track');\n\t\t\t\tvar ship = m_entity[data[0].id];\n\n\t\t\t\tvar shipRot = ship.getAttribute('rotation');\n\t\t\t\t//console.log(\"rot info: \", shipRot);\n\n\t\t\t\t// var action = null;\n\t\t\t\t// if (ship.className == \"boat\") {\n\t\t\t\t// \tfor(var i = 0; i < ship.childNodes.length; i++) {\n\t\t\t\t// \t\tif (ship.childNodes[i].className === \"aimShip\") {\n\t\t\t\t// \t\t\taction = ship.childNodes[i];\n\t\t\t\t// \t\t\tbreak;\n\t\t\t\t// \t\t}\n\t\t\t\t// \t}\n\t\t\t\t// \tif (action) {\n\t\t\t\t// \t\tvar shipY = ship.getAttribute('rotation').y;\n\t\t\t\t// \t\tvar current = action.getAttribute(\"rotation\").y;\n\t\t\t\t// \t\tvar radian = Math.atan((data[0].atZ-data[0].z)/(data[0].atX-data[0].x));\n\t\t\t\t// \t\tvar degree = -radian * 180 / Math.PI;\n\t\t\t\t// \t\tconsole.log(\"ship r: \", degree, current);\n\t\t\t\t// \t\tconsole.log(\"ship current rotation\", shipY);\n\t\t\t\t// \t\tvar rotated = rotateVector(data[0], shipY);\n\t\t\t\t// \t\tconsole.log(\"aim r: \", rotated);\n\t\t\t\t// \t\t//action.setAttribute('look-at', rotated);\n\t\t\t\t// \t\taction.setAttribute('rotation', '0 ' + (degree-shipY) + ' 0');\n\t\t\t\t// \t\t//action.removeAttribute('look-at');\n\t\t\t\t// \t}\n\t\t\t\t// }\n\n\t\t\t\tresolve();\n\t\t\t});\n\t\t},\n\n\t\thitShip: function hitShip(data) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tvar ship = m_entity[data[0].id];\n\t\t\t\tvar heart = \"\";\n\n\t\t\t\tfor (var i = 0; i < data[0].health; i++) {\n\t\t\t\t\theart += \" •\";\n\t\t\t\t}\n\n\t\t\t\tfor (var i = 0; i < ship.childNodes.length; i++) {\n\t\t\t\t\tif (ship.childNodes[i].className == \"ship-health\") {\n\t\t\t\t\t\tship.childNodes[i].setAttribute('text-geometry', 'value: ' + heart + ';');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tresolve();\n\t\t\t});\n\t\t},\n\n\t\t// Data passed in must be for movement of one ship\n\t\tmoveShip: function moveShip(data) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tvar shipDom = m_entity[data[0].id]; // html element\n\t\t\t\t// if statement is not working\n\t\t\t\t// if (data.length === 1 && data[0].x === shipDom.dataset.x && data[0].z === shipDom.dataset.z) {\n\t\t\t\t//     // if shipDom tries to move against edge or occupied place\n\t\t\t\t//     alert(\"Skipped\");\n\t\t\t\t//     resolve(\"Skipped\");\n\t\t\t\t// }\n\n\t\t\t\tvar doc = document.getElementById('scene'); // <a-scene> reference\n\t\t\t\tvar track = document.getElementById('track');\n\t\t\t\t//var startCoord = {\"x\": data[0].x};\n\n\t\t\t\tvar debug = document.createElement('a-draw-curve');\n\t\t\t\tdebug.setAttribute('curveref', '#track');\n\t\t\t\tdebug.setAttribute('material', 'shader: line; color: blue;');\n\t\t\t\tdoc.appendChild(debug);\n\n\t\t\t\t// add current location as a starting point of the curve\n\t\t\t\tvar point = document.createElement('a-curve-point');\n\t\t\t\tpoint.setAttribute('position', String(shipDom.dataset.x + \" \" + shipDom.dataset.y + \" \" + shipDom.dataset.z));\n\t\t\t\ttrack.appendChild(point);\n\t\t\t\t// add chain-able goal locations to the curve\n\n\t\t\t\t//previous is used to check for movement against walls, e.g. previous location same as current and next\n\t\t\t\t//previous can also be used to get the last action which determines the final rotation where the ship should point\n\t\t\t\tvar previous = { 'x': shipDom.dataset.x, 'z': shipDom.dataset.z };\n\t\t\t\tvar xDistance = 0;\n\t\t\t\tvar zDistance = 0;\n\t\t\t\t//console.log(\"Moving: \", data);\n\t\t\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\t\t\tpoint = document.createElement('a-curve-point');\n\t\t\t\t\tpoint.setAttribute('position', data[i].x + \" \" + data[i].y + \" \" + data[i].z);\n\t\t\t\t\txDistance += Math.abs(data[i].x - previous.x);\n\t\t\t\t\tzDistance += Math.abs(data[i].z - previous.z);\n\t\t\t\t\tif (i + 1 < data.length && data[i].x === data[i + 1].x && data[i].z === data[i + 1].z) {\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\ttrack.appendChild(point);\n\t\t\t\t\tprevious = { 'x': data[i].x, 'z': data[i].z, 'direction': data[i].direction };\n\t\t\t\t}\n\n\t\t\t\tvar dur = (xDistance + zDistance) * m_Constants.WaitTimePerTileMoved; // determines the length in time of the movement \n\t\t\t\tshipDom.setAttribute('alongpath', 'curve: #track; rotate: true; constraint: 0 0 -1; delay: ' + m_Constants.WaitTimeBetweenAction + '; dur: ' + dur + ';');\n\n\t\t\t\tvar done = function done(event) {\n\t\t\t\t\t// var list = document.getElementByTagName('a-draw-curve');\n\t\t\t\t\t// for (var i = 0; i < list.length; i++) {\n\t\t\t\t\t//     list[0].parentNode.removeChild(list[0]);\n\t\t\t\t\t// }\n\t\t\t\t\tif (debug.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(debug);\n\t\t\t\t\t}\n\n\t\t\t\t\twhile (track.hasChildNodes()) {\n\t\t\t\t\t\ttrack.removeChild(track.childNodes[0]);\n\t\t\t\t\t}\n\n\t\t\t\t\tshipDom.removeAttribute('alongpath');\n\t\t\t\t\tshipDom.dataset.x = data[data.length - 1].x;\n\t\t\t\t\tshipDom.dataset.z = data[data.length - 1].z;\n\t\t\t\t\tshipDom.dataset.y = data[data.length - 1].y;\n\n\t\t\t\t\t//shipDom.removeEventListener('movingended', done);\n\t\t\t\t\tresolve(event);\n\t\t\t\t};\n\n\t\t\t\tshipDom.addEventListener('movingended', done);\n\t\t\t});\n\t\t},\n\n\t\tsimulate: function simulate() {\n\t\t\t//console.log(\"chain: \", m_chain);\n\t\t\tvar notStop = true;\n\t\t\tif (m_chain.length == 0) {\n\t\t\t\tnotStop = false;\n\t\t\t}\n\t\t\tvar current = m_chain.shift(); // don't shift when length is zero\n\t\t\tif (current && notStop) {\n\t\t\t\t//console.log(\"current: \", current);\n\t\t\t\tswitch (current.type) {\n\t\t\t\t\tcase \"MOVE\":\n\t\t\t\t\t\tapp.moveShip(current.actions).then(function (done) {\n\t\t\t\t\t\t\t//alert(\"Moved \" + m_chain.length + \" actions left\");\n\t\t\t\t\t\t\tapp.simulate();\n\t\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"FIRE\":\n\t\t\t\t\t\t/*** Exclusive Or functions ***/\n\n\t\t\t\t\t\t/* Fire without aiming */\n\t\t\t\t\t\tapp.fireShip(current.actions).then(function (done) {\n\t\t\t\t\t\t\tapp.simulate();\n\t\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\t\tconsole.error(\"error: \", err);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// /* Aim then fire (currently buggy)*/\n\t\t\t\t\t\t// app.aimShip(current.actions).then((done) => {\n\t\t\t\t\t\t// \tapp.fireShip(current.actions).then((done) => {\n\t\t\t\t\t\t// \t\tapp.simulate();\n\t\t\t\t\t\t// \t}).catch((err) => {\n\t\t\t\t\t\t// \t\tconsole.error(\"error: \", err);\t\n\t\t\t\t\t\t// \t});\n\t\t\t\t\t\t// }).catch((err) => {\n\t\t\t\t\t\t// \tconsole.error(\"error: \", err);\n\t\t\t\t\t\t// });\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"HIT\":\n\t\t\t\t\t\tapp.hitShip(current.actions).then(function (done) {\n\t\t\t\t\t\t\tapp.simulate();\n\t\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"SINK\":\n\t\t\t\t\t\tapp.sinkShip(current.actions).then(function (done) {\n\t\t\t\t\t\t\t//alert(\"Sunk \"+ m_chain.length + \" actions left\");\n\t\t\t\t\t\t\tapp.simulate();\n\t\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.warn(\"Unknown Action Type \" + current.type + \" in simulate function, skipping.\");\n\t\t\t\t\t\tapp.simulate();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t//alert(\"Simulation Done\");\n\t\t\t\t\tvex.dialog.alert(\"Simulation Completed.\");\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t},\n\n\t\t/** translates the coordinate in the java game to this scene's coordinate\n  \tJava Game: Each ship spans one (x, y) unit\n  \tJava Game: Coordinate system has (0, 0) at top left corner (without negatives)\n  \tAFrame Scene: Each ship model is a 4x4 box\n  \tAFrame Scene: Coordinate system is (0, 0) at the center (with negatives)\n  */\n\t\tgetStrCoord: function getStrCoord(coord, offsetY) {\n\t\t\treturn (m_ocean.x - coord.x) * 4 + \" \" + offsetY + \" \" + (m_ocean.y - coord.y) * 4;\n\t\t},\n\n\t\tgetShips: function getShips() {\n\t\t\treturn m_ships;\n\t\t},\n\n\t\tgetOcean: function getOcean() {\n\t\t\treturn m_ocean;\n\t\t}\n\n\t};\n\n\treturn app;\n}\n\nvar app = battleship();\nvar params = getQueryParams(document.location.search);\n\nvar getDataFromCode = function getDataFromCode(code) {\n\tdb.ref('davy-jones-locker/' + code).once('value', function (snapshot) {\n\t\tvar gameData = snapshot.val();\n\t\tif (gameData) {\n\t\t\tinput = gameData;\n\t\t\tapp.init();\n\t\t} else {\n\t\t\tgetCode(\"No data for code \" + code + \". Enter another code:\");\n\t\t\t//app.init();\n\t\t}\n\t}).catch(function (err) {\n\t\tgetCode(\"There was an error. Enter another code:\");\n\t\t//app.init();\n\t});\n};\n\nvar getCode = function getCode(message) {\n\tvex.dialog.prompt({\n\t\tmessage: message,\n\t\tcallback: function callback(value) {\n\t\t\tif (value) {\n\t\t\t\tvar code = value;\n\t\t\t\tgetDataFromCode(code);\n\t\t\t} else {\n\t\t\t\tgetCode(\"No code entered. Enter your code:\");\n\t\t\t}\n\t\t}\n\t});\n};\n\nif (params.code) {\n\tgetDataFromCode(params.code);\n} else {\n\tgetCode(\"Enter Your Code\");\n}\n\n// var BATTLE_SERVER_URL = 'https://battleship-vingkan.c9users.io/1v1?p1=esi17.cs.DestroyerShip&p2=esi17.hli109.Floater';// + Math.ceil(Math.random() * 100);\n\n// $.get(BATTLE_SERVER_URL).then(data => {\n// \tinput = data;\n// \tapp.init();\n// }).done(() => {\n// \tconsole.log(\"Data successfully retrieved from server\");\n// }).fail(() => {\n// \tconsole.log(\"Unable to retrieve data, starting with local data\");\n// \tapp.init();\n// });\n\n},{}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvbWFpbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUE7QUFDQSxJQUFJLFNBQVM7QUFDWixTQUFRLHlDQURJO0FBRVosYUFBWSwwQkFGQTtBQUdaLGNBQWEsaUNBSEQ7QUFJWixZQUFXLFVBSkM7QUFLWixnQkFBZSxzQkFMSDtBQU1aLG9CQUFtQjtBQU5QLENBQWI7QUFRQSxJQUFJLG1CQUFtQixTQUFTLGFBQVQsQ0FBdUIsTUFBdkIsRUFBK0Isb0JBQS9CLENBQXZCOztBQUVBLElBQUksS0FBSyxpQkFBaUIsUUFBakIsRUFBVDs7QUFFQSxTQUFTLGNBQVQsQ0FBd0IsRUFBeEIsRUFBNEI7QUFDM0IsTUFBSyxHQUFHLEtBQUgsQ0FBUyxHQUFULEVBQWMsSUFBZCxDQUFtQixHQUFuQixDQUFMO0FBQ0EsS0FBSSxTQUFTLEVBQWI7QUFBQSxLQUNDLE1BREQ7QUFBQSxLQUVDLEtBQUssdUJBRk47QUFHQSxRQUFPLFNBQVMsR0FBRyxJQUFILENBQVEsRUFBUixDQUFoQixFQUE2QjtBQUM1QixTQUFPLG1CQUFtQixPQUFPLENBQVAsQ0FBbkIsQ0FBUCxJQUF3QyxtQkFBbUIsT0FBTyxDQUFQLENBQW5CLENBQXhDO0FBQ0E7QUFDRCxRQUFPLE1BQVA7QUFDQTs7QUFFRCxTQUFTLFVBQVQsR0FBc0I7O0FBRXJCO0FBQ0EsS0FBSSxjQUFjO0FBQ2pCLGlCQUFlLEVBREU7QUFFakIsZ0JBQWMsQ0FGRztBQUdqQixnQkFBYyxFQUhHO0FBSWpCLGVBQWEsQ0FKSTtBQUtqQixnQkFBYyxDQUxHO0FBTWpCLGFBQVcsQ0FOTTtBQU9qQix3QkFBc0IsR0FQTDtBQVFqQix5QkFBdUIsRUFSTixDQVFTO0FBUlQsRUFBbEI7O0FBV0EsS0FBSSxVQUFVLEVBQWQ7O0FBRUEsS0FBSSxVQUFVLEVBQWQsQ0FoQnFCLENBZ0JIO0FBQ2xCLEtBQUksVUFBVSxFQUFkLENBakJxQixDQWlC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UUFBRCxFQUFjO0FBQy9ELE1BQUksV0FBVyxTQUFTLEdBQVQsRUFBZjtBQUNBLE1BQUksUUFBSixFQUFjO0FBQ2IsV0FBUSxRQUFSO0FBQ0EsT0FBSSxJQUFKO0FBQ0EsR0FIRCxNQUdPO0FBQ04saUNBQTRCLElBQTVCO0FBQ0E7QUFDQTtBQUNELEVBVEQsRUFTRyxLQVRILENBU1MsVUFBQyxHQUFELEVBQVM7QUFDakI7QUFDQTtBQUNBLEVBWkQ7QUFhQSxDQWREOztBQWdCQSxJQUFJLFVBQVUsU0FBVixPQUFVLENBQUMsT0FBRCxFQUFhO0FBQzFCLEtBQUksTUFBSixDQUFXLE1BQVgsQ0FBa0I7QUFDakIsV0FBUyxPQURRO0FBRWpCLFlBQVUsa0JBQUMsS0FBRCxFQUFXO0FBQ3BCLE9BQUksS0FBSixFQUFXO0FBQ1YsUUFBSSxPQUFPLEtBQVg7QUFDQSxvQkFBZ0IsSUFBaEI7QUFDQSxJQUhELE1BR087QUFDTixZQUFRLG1DQUFSO0FBQ0E7QUFDRDtBQVRnQixFQUFsQjtBQVdBLENBWkQ7O0FBY0EsSUFBSSxPQUFPLElBQVgsRUFBaUI7QUFDaEIsaUJBQWdCLE9BQU8sSUFBdkI7QUFDQSxDQUZELE1BRU87QUFDTixTQUFRLGlCQUFSO0FBQ0E7O0FBR0Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8vIEluaXRpYWxpemUgRmlyZWJhc2VcbnZhciBjb25maWcgPSB7XG5cdGFwaUtleTogXCJBSXphU3lBOUVZVVhWTDVXQWg2QWFtMXFYbFd5dmkzYjdITGNaMVVcIixcblx0YXV0aERvbWFpbjogXCJlc2lnYW1tYS5maXJlYmFzZWFwcC5jb21cIixcblx0ZGF0YWJhc2VVUkw6IFwiaHR0cHM6Ly9lc2lnYW1tYS5maXJlYmFzZWlvLmNvbVwiLFxuXHRwcm9qZWN0SWQ6IFwiZXNpZ2FtbWFcIixcblx0c3RvcmFnZUJ1Y2tldDogXCJlc2lnYW1tYS5hcHBzcG90LmNvbVwiLFxuXHRtZXNzYWdpbmdTZW5kZXJJZDogXCI3MzQxNjM2MzYwMzlcIlxufTtcbnZhciBGaXJlYmFzZUluc3RhbmNlID0gZmlyZWJhc2UuaW5pdGlhbGl6ZUFwcChjb25maWcsIFwiRGF2eSBKb25lcycgTG9ja2VyXCIpO1xuXG52YXIgZGIgPSBGaXJlYmFzZUluc3RhbmNlLmRhdGFiYXNlKCk7XG5cbmZ1bmN0aW9uIGdldFF1ZXJ5UGFyYW1zKHFzKSB7XG5cdHFzID0gcXMuc3BsaXQoJysnKS5qb2luKCcgJyk7XG5cdHZhciBwYXJhbXMgPSB7fSxcblx0XHR0b2tlbnMsXG5cdFx0cmUgPSAvWz8mXT8oW149XSspPShbXiZdKikvZztcblx0d2hpbGUgKHRva2VucyA9IHJlLmV4ZWMocXMpKSB7XG5cdFx0cGFyYW1zW2RlY29kZVVSSUNvbXBvbmVudCh0b2tlbnNbMV0pXSA9IGRlY29kZVVSSUNvbXBvbmVudCh0b2tlbnNbMl0pO1xuXHR9XG5cdHJldHVybiBwYXJhbXM7XG59XG5cbmZ1bmN0aW9uIGJhdHRsZXNoaXAoKSB7XG5cdFxuXHQvLyBwcml2YXRlXG5cdHZhciBtX0NvbnN0YW50cyA9IHtcblx0XHRDYW1lcmFZT2Zmc2V0OiAyNSxcblx0XHRPY2VhbllPZmZzZXQ6IDAsXG5cdFx0T2NlYW5QYWRkaW5nOiAxMCxcblx0XHRTaGlwWU9mZnNldDogMCxcblx0XHRTaW5rRGlzdGFuY2U6IDUsXG5cdFx0QnVsbGV0QXJjOiAyLFxuXHRcdFdhaXRUaW1lUGVyVGlsZU1vdmVkOiAzMDAsXG5cdFx0V2FpdFRpbWVCZXR3ZWVuQWN0aW9uOiA1MCAvLyBpbiBtaWxpc2Vjb25kc1xuXHR9O1xuXG5cdHZhciBtX2lucHV0ID0ge307XG5cdFxuXHR2YXIgbV9zaGlwcyA9IFtdOyAvLyBzdG9yZXMgZm9ybWF0dGVkIGpzb24gb2Ygc2hpcCBpbml0aWFsaXphdGlvblxuXHR2YXIgbV9jaGFpbiA9IFtdOyAvLyBzdG9yZXMgY2hhaW5hYmxlIGFjdGlvbnMgaW4gYSB0dXJuXG5cdHZhciBtX2VudGl0eSA9IHt9OyAvLyBvYmplY3Qgd2l0aCBpZCB0byBodG1sIGRvbSBlbGVtZW50IG9mIHNoaXBzXG5cblx0dmFyIG1fdGVzdCA9IDA7XG5cblx0dmFyIG1fb2NlYW47IFxuXG5cdC8vIHB1YmxpY1xuXHR2YXIgYXBwID0ge1xuXG5cdFx0aW5pdDogKCkgPT4ge1xuXHRcdFx0Ly8gZGVmYXVsdCBhY2Nlc3Mgb2YgZGF0YSB3aGVuIHRoZXJlIGFyZSBubyBjb25uZWN0aXZpdHlcblx0XHRcdG1faW5wdXQgPSB7XCJzaGlwc1wiOiBpbnB1dC5pbml0LnNoaXBzLCBcInR1cm5zXCI6IGlucHV0LnR1cm5zLCBcIm9jZWFuXCI6IGlucHV0LmluaXQubWFwfTtcblx0XHRcdGFwcC5wcmVwcm9jZXNzKG1faW5wdXQpO1xuXG5cdFx0XHR2YXIgZG9jID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjZW5lJyk7XG5cdFx0XHR2YXIgdHJhY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWN1cnZlJyk7XG5cdFx0XHR0cmFjay5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3RyYWNrJyk7XG5cdFx0XHR0cmFjay5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnTGluZScpO1xuXHRcdFx0ZG9jLmFwcGVuZENoaWxkKHRyYWNrKTtcblxuXHRcdFx0YXBwLnJlbmRlcihtX3NoaXBzKTtcblxuXHRcdFx0LypzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0YXBwLnNpbXVsYXRlKCk7XG5cdFx0XHR9LCAxMDAwMCk7Ki9cblx0XHRcdHZleC5kaWFsb2cuY29uZmlybSh7XG5cdFx0XHRcdG1lc3NhZ2U6ICdSZWFkeSB0byB2aWV3IHRoZSBiYXR0bGU/Jyxcblx0XHRcdFx0YnV0dG9uczogW1xuXHRcdFx0XHRcdCQuZXh0ZW5kKHt9LCB2ZXguZGlhbG9nLmJ1dHRvbnMuWUVTLCB7XG5cdFx0XHRcdFx0XHRjbGFzc05hbWU6ICd2ZXgtZGlhbG9nLWJ1dHRvbi1wcmltYXJ5Jyxcblx0XHRcdFx0XHRcdHRleHQ6ICdQbGF5J1xuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdF0sXG5cdFx0XHRcdGNhbGxiYWNrOiAoZG9JdCkgPT4ge1xuXHRcdFx0XHRcdGlmIChkb0l0KSB7XG5cdFx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdFx0YXBwLnNpbXVsYXRlKCk7XG5cdFx0XHRcdFx0XHR9LCAxMDAwKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0Ly8gY2FsbCBmdW5jdGlvbiB0byB3YWl0IGEgYml0IGJlZm9yZSBzdGFydGluZyBzaW11bGF0aW9uXG5cdFx0XHQvL2FwcC5zaW11bGF0ZSgpO1xuXHRcdH0sXG5cblx0XHRwcmVwcm9jZXNzOiAoZGF0YSkgPT4ge1xuXHRcdFx0dmFyIHRyYW5zbGF0ZSA9IChkKSA9PiB7XG5cdFx0XHRcdHZhciByZXMgPSBkO1xuXHRcdFx0XHRpZiAocmVzLmhhc093blByb3BlcnR5KFwiYXRYXCIpICYmIHJlcy5oYXNPd25Qcm9wZXJ0eShcImF0WVwiKSkge1xuXHRcdFx0XHRcdHJlc1snYXRYJ10gPSA0KmQuYXRYO1xuXHRcdFx0XHRcdHJlc1snYXRaJ10gPSA0KmQuYXRZOyAvLyBtYWtlIHN1cmUgdG8gbW92ZSB0aGUgeSBwcm9wZXJ0eSBiZWZvcmUgb3ZlcnJpZGluZyBpdFxuXHRcdFx0XHRcdHJlc1snYXRZJ10gPSBtX0NvbnN0YW50cy5TaGlwWU9mZnNldDtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXMueCA9IDQqZC54O1xuXHRcdFx0XHRyZXMueiA9IDQqZC55OyAvLyBtYWtlIHN1cmUgdG8gbW92ZSB0aGUgeSBwcm9wZXJ0eSBiZWZvcmUgb3ZlcnJpZGluZyBpdFxuXHRcdFx0XHRyZXMueSA9IG1fQ29uc3RhbnRzLlNoaXBZT2Zmc2V0O1xuXHRcdFx0XHRyZXR1cm4gcmVzO1xuXHRcdFx0fTtcblx0XHRcdHZhciBhY3Rpb25zID0gW107XG5cdFx0XHR2YXIgaW5kZXggPSAwO1xuXG5cdFx0XHQvLyBwcmVwcm9jZXNzIGluaXRpYWwgbWFwIGluZm9ybWF0aW9uXG5cdFx0XHQvLyBtX29jZWFuID0geyBcInhcIjogKCg0Kk1hdGguZmxvb3IoZGF0YS5vY2Vhbi54LzIpKS0yKSArIChtX0NvbnN0YW50cy5PY2VhblBhZGRpbmcvMiksXG5cdFx0XHQvLyAgICAgICAgICAgICBcInlcIjogbV9Db25zdGFudHMuT2NlYW5ZT2Zmc2V0LCBcblx0XHRcdC8vICAgICAgICAgICAgIFwielwiOiAoKDQqTWF0aC5mbG9vcihkYXRhLm9jZWFuLnkvMikpKSArIChtX0NvbnN0YW50cy5PY2VhblBhZGRpbmcvMiksIFxuXHRcdFx0Ly8gICAgICAgICAgICAgXCJ3aWR0aFwiOiAoNCpkYXRhLm9jZWFuLngpK21fQ29uc3RhbnRzLk9jZWFuUGFkZGluZywgXG5cdFx0XHQvLyAgICAgICAgICAgICBcImRlcHRoXCI6ICg0KmRhdGEub2NlYW4ueSkrbV9Db25zdGFudHMuT2NlYW5QYWRkaW5nLCBcblx0XHRcdC8vICAgICAgICAgICAgIFwiZGVuc2l0eVwiOiBNYXRoLm1pbigzKmRhdGEub2NlYW4ueCwgMypkYXRhLm9jZWFuLnkpK21fQ29uc3RhbnRzLk9jZWFuUGFkZGluZ1xuXHRcdFx0Ly8gICAgICAgICB9O1xuXHRcdFx0bV9vY2VhbiA9IHsgXCJ4XCI6ICgoNCpNYXRoLmZsb29yKGRhdGEub2NlYW4ueC8yKSktMiksXG5cdFx0XHRcdFx0XHRcInlcIjogbV9Db25zdGFudHMuT2NlYW5ZT2Zmc2V0LCBcblx0XHRcdFx0XHRcdFwielwiOiAoKDQqTWF0aC5mbG9vcihkYXRhLm9jZWFuLnkvMikpKSxcblx0XHRcdFx0XHRcdFwid2lkdGhcIjogNDAwLCBcblx0XHRcdFx0XHRcdFwiZGVwdGhcIjogNDAwLFxuXHRcdFx0XHRcdFx0XCJkZW5zaXR5XCI6IDI0MCxcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHQvLyBwcmVwcm9jZXNzIGluaXRpYWwgc2hpcCBpbmZvcm1hdGlvblxuXHRcdFx0ZGF0YS5zaGlwcy5mb3JFYWNoKChlbnRyeSkgPT4ge1xuXHRcdFx0XHRtX3NoaXBzLnB1c2godHJhbnNsYXRlKGVudHJ5KSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gcHJlcHJvY2VzcyBhY3Rpb25zIGFuZCB0dXJucyBpbmZvcm1hdGlvblxuXHRcdFx0d2hpbGUoaW5kZXggPCBkYXRhLnR1cm5zLmxlbmd0aCkge1xuXHRcdFx0XHR2YXIgY2hhaW4gPSB0cnVlO1xuXHRcdFx0XHR3aGlsZShjaGFpbikge1xuXHRcdFx0XHRcdGlmIChpbmRleCA9PT0gZGF0YS50dXJucy5sZW5ndGgpXG5cdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGlmIChhY3Rpb25zLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRcdFx0YWN0aW9ucy5wdXNoKHRyYW5zbGF0ZShkYXRhLnR1cm5zW2luZGV4XSkpO1xuXHRcdFx0XHRcdFx0aW5kZXgrKztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Ly8gU2hpcCBpZCBhbmQgYWN0aW9uIHR5cGUgaGFzIHRvIGJlIHRoZSBzYW1lIHRvIGJlIGNvbnNpZGVyZWQgYSBjaGFpbi1hYmxlIGFjdGlvblxuXHRcdFx0XHRcdGVsc2UgaWYgKGFjdGlvbnNbMF0uaWQgPT09IGRhdGEudHVybnNbaW5kZXhdLmlkICYmIGFjdGlvbnNbMF0udHlwZSA9PT0gZGF0YS50dXJuc1tpbmRleF0udHlwZSkge1xuXHRcdFx0XHRcdFx0aWYgKGFjdGlvbnNbMF0udHlwZSA9PT0gXCJNT1ZFXCIpIHtcblx0XHRcdFx0XHRcdFx0YWN0aW9ucy5wdXNoKHRyYW5zbGF0ZShkYXRhLnR1cm5zW2luZGV4XSkpO1xuXHRcdFx0XHRcdFx0XHRpbmRleCsrO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0Ly8gRmlyaW5nIG11c3QgYmUgYXQgdGhlIHNhbWUgY29vcmRpbmF0ZXMgdG8gYmUgY29uc2lkZXJlZCBhIGNoYWluLWFibGUgYWN0aW9uXG5cdFx0XHRcdFx0XHRlbHNlIGlmIChhY3Rpb25zWzBdLnR5cGUgPT09IFwiRklSRVwiICYmIGFjdGlvbnNbMF0uYXRYID09PSA0KihkYXRhLnR1cm5zW2luZGV4XS5hdFgpICYmIGFjdGlvbnNbMF0uYXRZID09PSA0KihkYXRhLnR1cm5zW2luZGV4XS5hdFkpKSB7XG5cdFx0XHRcdFx0XHRcdGFjdGlvbnMucHVzaCh0cmFuc2xhdGUoZGF0YS50dXJuc1tpbmRleF0pKTtcblx0XHRcdFx0XHRcdFx0aW5kZXgrKztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGVsc2UgaWYoYWN0aW9uc1swXS50eXBlID09PSBcIlNJTktcIikge1xuXHRcdFx0XHRcdFx0XHRhY3Rpb25zLnB1c2godHJhbnNsYXRlKGRhdGEudHVybnNbaW5kZXhdKSk7XG5cdFx0XHRcdFx0XHRcdGluZGV4Kys7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRcdFx0Y2hhaW4gPSBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0XHRjaGFpbiA9IGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBhZGQgYWN0aW9uIGNoYWluIHRvIHZhcmlhYmxlXG5cdFx0XHRcdG1fY2hhaW4ucHVzaCh7XCJ0eXBlXCI6IGFjdGlvbnNbMF0udHlwZSwgXCJhY3Rpb25zXCI6IGFjdGlvbnN9KTtcblx0XHRcdFx0Ly8gcmVzZXQgY2hhaW4gYWN0aW9uc1xuXHRcdFx0XHRhY3Rpb25zID0gW107XG5cdFx0XHR9XG5cdFx0fSxcblxuXG5cblx0XHQvLyBEaXNwbGF5cyB0aGUgb2NlYW4sIGFuZCBzaGlwc1xuXHRcdC8vIFRPRE86IGNoZWNrIHRoZSBlZGdlIGNhc2VzIHdpdGggdGhlIG1hcCBlZGdlcy9zaXplc1xuXHRcdHJlbmRlcjogKHNoaXBEYXRhKSA9PiB7XG5cdFx0XHR2YXIgZG9jID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjZW5lJyk7IC8vIDxhLXNjZW5lPiByZWZlcmVuY2VcblxuXHRcdFx0Ly8gcmUtcG9zaXRpb24gY2FtZXJhOiBjYW1lcmEgbXVzdCBiZSBhbHJlYWR5IHByZXNlbnQgd2hlbiBodG1sIGxvYWRzXG5cdFx0XHR2YXIgY2FtZXJhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbWVyYScpO1xuXHRcdFx0Ly9jYW1lcmEuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIG1fb2NlYW4ueCArIFwiIFwiICsgbV9vY2Vhbi55ICsgXCIgXCIgKyBtX29jZWFuLnopO1xuXHRcdFx0Y2FtZXJhLnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBtX29jZWFuLnggKyBcIiBcIiArIG1fb2NlYW4ueSArIFwiIFwiICsgKG1fb2NlYW4ueisoMS41Km1fb2NlYW4ueCkpKTtcblx0XHRcdGNhbWVyYS5zZXRBdHRyaWJ1dGUoJ2NhbWVyYScsICd1c2VySGVpZ2h0OiAnICsgbV9Db25zdGFudHMuQ2FtZXJhWU9mZnNldCk7XG5cdFx0XHQvL2NhbWVyYS5zZXRBdHRyaWJ1dGUoJ3JvdGF0aW9uJywgLU1hdGguYXRhbihtX0NvbnN0YW50cy5DYW1lcmFZT2Zmc2V0LyhtX29jZWFuLnorbV9vY2Vhbi54KSkpOyAvLyBUT0RPOiBjaGVjayBpZiB0aGUgc3RyaW5nIGlzIGEgdmVjM1xuXHRcdFx0Y2FtZXJhLnNldEF0dHJpYnV0ZSgncm90YXRpb24nLCAnLTUwIDAgMCcpO1xuXG5cdFx0XHQvLyBHZW5lcmF0ZSBNYXBcblx0XHRcdC8vIFRPRE86IFBvc3NpYmxlIGVkZ2UgY2FzZXMgd2l0aCB0aGUgbWFwIGVkZ2Ugbm90IGJlaW5nIGJpZyBlbm91Z2hcblx0XHRcdHZhciBtYXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLW9jZWFuJyk7XG5cblx0XHRcdG1hcC5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgbV9vY2Vhbi54ICsgXCIgXCIgKyBtX29jZWFuLnkgKyBcIiBcIiArIG1fb2NlYW4ueik7XG5cdFx0XHRtYXAuc2V0QXR0cmlidXRlKCd3aWR0aCcsIFN0cmluZyhtX29jZWFuLndpZHRoKSk7XG5cdFx0XHRtYXAuc2V0QXR0cmlidXRlKCdkZXB0aCcsIFN0cmluZyhtX29jZWFuLmRlcHRoKSk7XG5cdFx0XHRtYXAuc2V0QXR0cmlidXRlKCdkZW5zaXR5JywgU3RyaW5nKG1fb2NlYW4uZGVuc2l0eSkpO1xuXHRcdFx0ZG9jLmFwcGVuZENoaWxkKG1hcCk7XG5cblx0XHRcdHZhciBzcGF3blNoaXAgPSAoZW50cnkpID0+IHtcblx0XHRcdFx0dmFyIHNoaXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWVudGl0eScpO1xuXG5cdFx0XHRcdHNoaXAuZGF0YXNldC5pZCA9IGVudHJ5LmlkO1xuXHRcdFx0XHRzaGlwLmRhdGFzZXQubmFtZSA9IGVudHJ5Lm5hbWU7XG5cdFx0XHRcdHNoaXAuZGF0YXNldC5vd25lciA9IGVudHJ5Lm93bmVyO1xuXHRcdFx0XHRzaGlwLmRhdGFzZXQueCA9IGVudHJ5Lng7XG5cdFx0XHRcdHNoaXAuZGF0YXNldC55ID0gZW50cnkueTtcblx0XHRcdFx0c2hpcC5kYXRhc2V0LnogPSBlbnRyeS56O1xuXHRcdFx0XHRzaGlwLmRhdGFzZXQuaGVhbHRoID0gZW50cnkuaHVsbDtcblx0XHRcdFx0c2hpcC5kYXRhc2V0Lmh1bGwgPSBlbnRyeS5odWxsO1xuXHRcdFx0XHRzaGlwLmRhdGFzZXQuZmlyZXBvd2VyID0gZW50cnkuZmlyZXBvd2VyO1xuXHRcdFx0XHRzaGlwLmRhdGFzZXQuc3BlZWQgPSBlbnRyeS5zcGVlZDtcblx0XHRcdFx0c2hpcC5kYXRhc2V0LnJhbmdlID0gZW50cnkucmFuZ2U7XG5cblx0XHRcdFx0dmFyIGhlYXJ0ID0gXCJcIjtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBwYXJzZUludChlbnRyeS5odWxsKTsgaSsrKSB7XG5cdFx0XHRcdFx0aGVhcnQgKz0gXCIg4oCiXCI7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzaGlwLnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBlbnRyeS54ICsgXCIgXCIgKyBlbnRyeS55ICsgXCIgXCIgKyBlbnRyeS56KTtcblxuXHRcdFx0XHRpZiAoZW50cnkuY29sb3IgPT09IFwicmdiKDI1NSwgMjU1LCAwKVwiKSB7XG5cdFx0XHRcdFx0c2hpcC5zZXRBdHRyaWJ1dGUoJ3RlbXBsYXRlJywgJ3NyYzogI3N1Ym1hcmluZS10ZW1wbGF0ZScpO1xuXHRcdFx0XHRcdHNoaXAuc2V0QXR0cmlidXRlKCdjbGFzcycsICdzdWJtYXJpbmUnKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRzaGlwLnNldEF0dHJpYnV0ZSgndGVtcGxhdGUnLCAnc3JjOiAjYm9hdC10ZW1wbGF0ZScpO1xuXHRcdFx0XHRcdHNoaXAuc2V0QXR0cmlidXRlKCdjbGFzcycsICdib2F0Jyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyAke3ZhcmlhYmxlfSA8LSB2YXJpYWJsZSBuYW1lIGJlIGxvd2VyIGNhc2Vcblx0XHRcdFx0c2hpcC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2hpcF9jb2xvcicsICdjb2xvcjogJytlbnRyeS5jb2xvcisnOyBtZXRhbG5lc3M6IDAuNDsnKTtcblx0XHRcdFx0c2hpcC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2hpcF9uYW1lJywgJ3ZhbHVlOiAnK2VudHJ5Lm5hbWUrJzsgZm9udDogI3BsYXk7Jyk7XG5cdFx0XHRcdHNoaXAuc2V0QXR0cmlidXRlKCdkYXRhLXNoaXBfaGVhbHRoJywgJ3ZhbHVlOiAnK2hlYXJ0Kyc7Jyk7XG5cblx0XHRcdFx0dmFyIHNoaXBJbnN0YW5jZSA9IGRvYy5hcHBlbmRDaGlsZChzaGlwKTtcblx0XHRcdFx0bV9lbnRpdHlbZW50cnkuaWRdID0gc2hpcEluc3RhbmNlO1xuXHRcdFx0fTtcblx0XHRcdC8vIHNwYXduIHRoZSBzaGlwcyFcblx0XHRcdHNoaXBEYXRhLmZvckVhY2goKGVudHJ5KSA9PiB7XG5cdFx0XHRcdHNwYXduU2hpcChlbnRyeSk7XG5cdFx0XHR9KVxuXHRcdH0sXG5cblx0XHRzaW5rU2hpcDogKGRhdGEpID0+IHtcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRcdHZhciBkb2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NlbmUnKTtcblx0XHRcdFx0dmFyIHRyYWNrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyYWNrJyk7XG5cdFx0XHRcdHZhciBzaGlwRG9tID0gbV9lbnRpdHlbZGF0YVswXS5pZF07XG5cblx0XHRcdFx0dmFyIGRlYnVnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1kcmF3LWN1cnZlJyk7XG5cdFx0XHRcdGRlYnVnLnNldEF0dHJpYnV0ZSgnY3VydmVyZWYnLCAnI3RyYWNrJyk7XG5cdFx0XHRcdGRlYnVnLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCAnc2hhZGVyOiBsaW5lOyBjb2xvcjogYmxhY2s7Jyk7XG5cdFx0XHRcdGRvYy5hcHBlbmRDaGlsZChkZWJ1Zyk7XG5cblx0XHRcdFx0dmFyIHBvaW50MSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtY3VydmUtcG9pbnQnKTtcblx0XHRcdFx0dmFyIHBvaW50MiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtY3VydmUtcG9pbnQnKTtcblx0XHRcdFx0cG9pbnQxLnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBkYXRhWzBdLnggKyBcIiBcIiArIGRhdGFbMF0ueSArIFwiIFwiICsgZGF0YVswXS56KTtcblx0XHRcdFx0cG9pbnQyLnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBkYXRhWzBdLnggKyBcIiBcIiArIChkYXRhWzBdLnktbV9Db25zdGFudHMuU2lua0Rpc3RhbmNlKSArIFwiIFwiICsgZGF0YVswXS56KTtcblx0XHRcdFx0dHJhY2suYXBwZW5kQ2hpbGQocG9pbnQxKTtcblx0XHRcdFx0dHJhY2suYXBwZW5kQ2hpbGQocG9pbnQyKTtcblxuXHRcdFx0XHRzaGlwRG9tLnNldEF0dHJpYnV0ZSgnYWxvbmdwYXRoJywgJ2N1cnZlOiAjdHJhY2s7IHJvdGF0ZTogZmFsc2U7IGRlbGF5OiAnK21fQ29uc3RhbnRzLldhaXRUaW1lQmV0d2VlbkFjdGlvbisnOyBkdXI6IDEwMDA7Jyk7XG5cblx0XHRcdFx0dmFyIGRvbmUgPSAoZXZlbnQpID0+IHtcblx0XHRcdFx0XHRzaGlwRG9tLnJlbW92ZUF0dHJpYnV0ZSgnYWxvbmdwYXRoJyk7XG5cdFx0XHRcdFx0aWYgKGRlYnVnLnBhcmVudE5vZGUpIHtcblx0XHRcdFx0XHRcdGRvYy5yZW1vdmVDaGlsZChkZWJ1Zyk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0d2hpbGUodHJhY2suaGFzQ2hpbGROb2RlcygpKSB7XG5cdFx0XHRcdFx0XHR0cmFjay5yZW1vdmVDaGlsZCh0cmFjay5jaGlsZE5vZGVzWzBdKTtcblx0XHRcdFx0XHR9XG5cblxuXHRcdFx0XHRcdC8vc2hpcERvbS5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3ZpbmdlbmRlZCcsIGRvbmUpO1xuXG5cdFx0XHRcdFx0aWYgKHNoaXBEb20ucGFyZW50Tm9kZSkge1xuXHRcdFx0XHRcdFx0ZG9jLnJlbW92ZUNoaWxkKHNoaXBEb20pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJlc29sdmUoZXZlbnQpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHNoaXBEb20uYWRkRXZlbnRMaXN0ZW5lcignbW92aW5nZW5kZWQnLCBkb25lKTtcblx0XHRcdFx0Ly8gcmVzb2x2ZSgpO1xuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdC8vIERhdGEgcGFzc2VkIGluIGFyZSBvbmUgc2hpcHMgYWN0aW9uIG9mIGZpcmluZyBhdCBvbmUgYW5kIG9ubHkgb25lIGNvb3JkaW5hdGVcblx0XHRmaXJlU2hpcDogKGRhdGEpID0+IHtcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRcdHZhciBkb2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NlbmUnKTtcblx0XHRcdFx0dmFyIHRyYWNrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyYWNrJyk7XG5cdFx0XHRcdHZhciBzaGlwID0gbV9lbnRpdHlbZGF0YVswXS5pZF07XG5cblx0XHRcdFx0dmFyIGJ1bGxldCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Etc3BoZXJlJyk7XG5cdFx0XHRcdHZhciBzb3VyY2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWN1cnZlLXBvaW50Jyk7XG5cdFx0XHRcdHZhciBhcmMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWN1cnZlLXBvaW50Jyk7XG5cdFx0XHRcdHZhciB0YXJnZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWN1cnZlLXBvaW50Jyk7XG5cblx0XHRcdFx0Ly8gdmFyIHNhdmVzID0gbnVsbDtcblx0XHRcdFx0Ly8gaWYgKHNoaXAuY2xhc3NOYW1lID09PSBcInN1Ym1hcmluZVwiKSB7XG5cdFx0XHRcdC8vIFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBzaGlwLmNoaWxkTm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0Ly8gXHRcdGlmIChzaGlwLmNoaWxkTm9kZXNbaV0uY2xhc3NOYW1lID09PSBcInN1Ym1hcmluZU1pc3NpbGVcIikge1xuXHRcdFx0XHQvLyBcdFx0XHRidWxsZXQgPSBzaGlwLmNoaWxkTm9kZXNbaV1cblx0XHRcdFx0Ly8gXHRcdFx0c2F2ZXMgPSBidWxsZXQuZ2V0QXR0cmlidXRlKCdwb3NpdGlvbicpO1xuXHRcdFx0XHQvLyBcdFx0XHRicmVhaztcblx0XHRcdFx0Ly8gXHRcdH1cblx0XHRcdFx0Ly8gXHR9XG5cdFx0XHRcdC8vIFx0Y29uc29sZS5sb2coJ21pc3NpbGUgc3RhcnQnLCBzYXZlcyk7XG5cdFx0XHRcdC8vIFx0c291cmNlLnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCAoZGF0YVswXS54K3NhdmVzLngpICsgXCIgXCIgKyAoZGF0YVswXS55K3NhdmVzLnkpICsgXCIgXCIgKyAoZGF0YVswXS56K3NhdmVzLnopKTtcblx0XHRcdFx0Ly8gXHRhcmMuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIChkYXRhWzBdLngrc2F2ZXMueCkgKyBcIiBcIiArIChkYXRhWzBdLnkrc2F2ZXMueSs1KSArIFwiIFwiICsgKGRhdGFbMF0ueitzYXZlcy56KSk7XG5cdFx0XHRcdC8vIFx0dGFyZ2V0LnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBkYXRhWzBdLmF0WCArIFwiIFwiICsgZGF0YVswXS5hdFkgKyBcIiBcIiArIGRhdGFbMF0uYXRaKTtcblx0XHRcdFx0Ly8gXHR0cmFjay5hcHBlbmRDaGlsZChzb3VyY2UpO1xuXHRcdFx0XHQvLyBcdHRyYWNrLmFwcGVuZENoaWxkKGFyYyk7XG5cdFx0XHRcdC8vIFx0dHJhY2suYXBwZW5kQ2hpbGQodGFyZ2V0KTtcblx0XHRcdFx0Ly8gfVxuXHRcdFx0XHQvLyBlbHNlIHtcblx0XHRcdFx0XHRidWxsZXQuc2V0QXR0cmlidXRlKCdjb2xvcicsICdncmF5Jyk7XG5cdFx0XHRcdFx0YnVsbGV0LnNldEF0dHJpYnV0ZSgncmFkaXVzJywgJzAuMicpO1xuXHRcdFx0XHRcdGJ1bGxldC5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgZGF0YVswXS54ICsgXCIgXCIgKyBkYXRhWzBdLnkgKyBcIiBcIiArIGRhdGFbMF0ueik7XG5cdFx0XHRcdFx0c291cmNlLnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBkYXRhWzBdLnggKyBcIiBcIiArIGRhdGFbMF0ueSArIFwiIFwiICsgZGF0YVswXS56KTtcblx0XHRcdFx0XHRhcmMuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIChkYXRhWzBdLmF0WCtkYXRhWzBdLngpLzIgKyBcIiBcIiArICgoKGRhdGFbMF0uYXRZK2RhdGFbMF0ueSkvMikrbV9Db25zdGFudHMuQnVsbGV0QXJjKSArIFwiIFwiICsgKGRhdGFbMF0uYXRaK2RhdGFbMF0ueikvMik7XG5cdFx0XHRcdFx0dGFyZ2V0LnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBkYXRhWzBdLmF0WCArIFwiIFwiICsgZGF0YVswXS5hdFkgKyBcIiBcIiArIGRhdGFbMF0uYXRaKTtcblx0XHRcdFx0XHR0cmFjay5hcHBlbmRDaGlsZChzb3VyY2UpO1xuXHRcdFx0XHRcdHRyYWNrLmFwcGVuZENoaWxkKGFyYyk7XG5cdFx0XHRcdFx0dHJhY2suYXBwZW5kQ2hpbGQodGFyZ2V0KTtcblx0XHRcdFx0Ly8gfVxuXG5cdFx0XHRcdHZhciBkZWJ1ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZHJhdy1jdXJ2ZScpO1xuXHRcdFx0XHRkZWJ1Zy5zZXRBdHRyaWJ1dGUoJ2N1cnZlcmVmJywgJyN0cmFjaycpO1xuXHRcdFx0XHRkZWJ1Zy5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywgJ3NoYWRlcjogbGluZTsgY29sb3I6IHJlZDsnKTtcblx0XHRcdFx0ZG9jLmFwcGVuZENoaWxkKGRlYnVnKTtcblxuXHRcdFx0XHR2YXIgdG1wID0gZG9jLmFwcGVuZENoaWxkKGJ1bGxldCk7XG5cdFx0XHRcdHZhciBkaXN0YW5jZSA9IE1hdGguc3FydCgoZGF0YVswXS5hdFgtZGF0YVswXS54KSooZGF0YVswXS5hdFgtZGF0YVswXS54KSArIChkYXRhWzBdLmF0Wi1kYXRhWzBdLnopKihkYXRhWzBdLmF0Wi1kYXRhWzBdLnopKSttX0NvbnN0YW50cy5CdWxsZXRBcmMqbV9Db25zdGFudHMuQnVsbGV0QXJjO1xuXHRcdFx0XHQvL2NvbnNvbGUubG9nKFwiZGlzdGFuY2U6IFwiLCBkaXN0YW5jZSk7XG5cdFx0XHRcdHRtcC5zZXRBdHRyaWJ1dGUoJ2Fsb25ncGF0aCcsICdjdXJ2ZTogI3RyYWNrOyByb3RhdGU6IHRydWU7IGNvbnN0YW50OiAwIC0xIDA7IGRlbGF5OiAxMDA7IGR1cjogJyArIDI1KmRpc3RhbmNlKTtcblxuXHRcdFx0XHR2YXIgZG9uZSA9IChldmVudCkgPT4ge1xuXHRcdFx0XHRcdHRtcC5yZW1vdmVBdHRyaWJ1dGUoJ2Fsb25ncGF0aCcpO1xuXHRcdFx0XHRcdGlmIChkZWJ1Zy5wYXJlbnROb2RlKSB7XG5cdFx0XHRcdFx0XHRkb2MucmVtb3ZlQ2hpbGQoZGVidWcpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR3aGlsZSh0cmFjay5oYXNDaGlsZE5vZGVzKCkpIHtcblx0XHRcdFx0XHRcdHRyYWNrLnJlbW92ZUNoaWxkKHRyYWNrLmNoaWxkTm9kZXNbMF0pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vdG1wLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdmluZ2VuZGVkJywgZG9uZSk7XG5cdFx0XHRcdFx0aWYgKHRtcC5wYXJlbnROb2RlKSB7XG5cdFx0XHRcdFx0XHRkb2MucmVtb3ZlQ2hpbGQodG1wKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Ly8gaWYgKHNoaXAuY2xhc3NOYW1lID09PSBcInN1Ym1hcmluZVwiKSB7XG5cdFx0XHRcdFx0Ly8gXHR2YXIgcmVsb2FkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcblx0XHRcdFx0XHQvLyBcdHJlbG9hZC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3N1Ym1hcmluZU1pc3NpbGUnKTtcblx0XHRcdFx0XHQvLyBcdHJlbG9hZC5zZXRBdHRyaWJ1dGUoJ29iai1tb2RlbCcsICdvYmo6ICNzdWJtYXJpbmVNaXNzaWxlJyk7XG5cdFx0XHRcdFx0Ly8gXHRyZWxvYWQuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIHNhdmVzKTtcblx0XHRcdFx0XHQvLyBcdHNoaXAuYXBwZW5kQ2hpbGQocmVsb2FkKTtcblx0XHRcdFx0XHQvLyB9XG5cblx0XHRcdFx0XHRyZXNvbHZlKGV2ZW50KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRtcC5hZGRFdmVudExpc3RlbmVyKCdtb3ZpbmdlbmRlZCcsIGRvbmUpO1xuXHRcdFx0XHQvL3Jlc29sdmUoKTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cblx0XHRhaW1TaGlwOiAoZGF0YSkgPT4ge1xuXHRcdFx0dmFyIHJvdGF0ZVZlY3RvciA9ICh2ZWMyLCBkZWcpID0+IHtcblx0XHRcdFx0dmFyIHJhZCA9IC1kZWcgKiBNYXRoLlBJIC8gMTgwO1xuXHRcdFx0XHR2YXIgY29zID0gTWF0aC5jb3MocmFkKTtcblx0XHRcdFx0dmFyIHNpbiA9IE1hdGguc2luKHJhZCk7XG5cdFx0XHRcdC8vY29uc29sZS5sb2coXCJ2ZWN0b3I6IFwiLCB2ZWMyKTtcblx0XHRcdFx0Ly9jb25zb2xlLmxvZyhcImRlZ3JlZTogXCIsIGRlZyk7XG5cdFx0XHRcdC8vIHJvdW5kIHRoZSBudW1iZXJzXG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XCJ4XCI6IE1hdGgucm91bmQoMTAwMDAwKigodmVjMi54LXZlYzIuYXRYKSAqIGNvcyAtICh2ZWMyLnotdmVjMi5hdFopICogc2luKSkvMTAwMDAwLCBcblx0XHRcdFx0XHRcInlcIjogKHZlYzIueS12ZWMyLmF0WSksXG5cdFx0XHRcdFx0XCJ6XCI6IE1hdGgucm91bmQoMTAwMDAwKigodmVjMi54LXZlYzIuYXRYKSAqIHNpbiArICh2ZWMyLnotdmVjMi5hdFopICogY29zKSkvMTAwMDAwXG5cdFx0XHRcdH07XG5cdFx0XHR9O1xuXG5cdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0XHQvL2NvbnNvbGUubG9nKCdhaW0gaW5mbzogJywgZGF0YSk7XG5cdFx0XHRcdHZhciBkb2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NlbmUnKTtcblx0XHRcdFx0dmFyIHRyYWNrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyYWNrJyk7XG5cdFx0XHRcdHZhciBzaGlwID0gbV9lbnRpdHlbZGF0YVswXS5pZF07XG5cblx0XHRcdFx0dmFyIHNoaXBSb3QgPSBzaGlwLmdldEF0dHJpYnV0ZSgncm90YXRpb24nKTtcblx0XHRcdFx0Ly9jb25zb2xlLmxvZyhcInJvdCBpbmZvOiBcIiwgc2hpcFJvdCk7XG5cblx0XHRcdFx0Ly8gdmFyIGFjdGlvbiA9IG51bGw7XG5cdFx0XHRcdC8vIGlmIChzaGlwLmNsYXNzTmFtZSA9PSBcImJvYXRcIikge1xuXHRcdFx0XHQvLyBcdGZvcih2YXIgaSA9IDA7IGkgPCBzaGlwLmNoaWxkTm9kZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0Ly8gXHRcdGlmIChzaGlwLmNoaWxkTm9kZXNbaV0uY2xhc3NOYW1lID09PSBcImFpbVNoaXBcIikge1xuXHRcdFx0XHQvLyBcdFx0XHRhY3Rpb24gPSBzaGlwLmNoaWxkTm9kZXNbaV07XG5cdFx0XHRcdC8vIFx0XHRcdGJyZWFrO1xuXHRcdFx0XHQvLyBcdFx0fVxuXHRcdFx0XHQvLyBcdH1cblx0XHRcdFx0Ly8gXHRpZiAoYWN0aW9uKSB7XG5cdFx0XHRcdC8vIFx0XHR2YXIgc2hpcFkgPSBzaGlwLmdldEF0dHJpYnV0ZSgncm90YXRpb24nKS55O1xuXHRcdFx0XHQvLyBcdFx0dmFyIGN1cnJlbnQgPSBhY3Rpb24uZ2V0QXR0cmlidXRlKFwicm90YXRpb25cIikueTtcblx0XHRcdFx0Ly8gXHRcdHZhciByYWRpYW4gPSBNYXRoLmF0YW4oKGRhdGFbMF0uYXRaLWRhdGFbMF0ueikvKGRhdGFbMF0uYXRYLWRhdGFbMF0ueCkpO1xuXHRcdFx0XHQvLyBcdFx0dmFyIGRlZ3JlZSA9IC1yYWRpYW4gKiAxODAgLyBNYXRoLlBJO1xuXHRcdFx0XHQvLyBcdFx0Y29uc29sZS5sb2coXCJzaGlwIHI6IFwiLCBkZWdyZWUsIGN1cnJlbnQpO1xuXHRcdFx0XHQvLyBcdFx0Y29uc29sZS5sb2coXCJzaGlwIGN1cnJlbnQgcm90YXRpb25cIiwgc2hpcFkpO1xuXHRcdFx0XHQvLyBcdFx0dmFyIHJvdGF0ZWQgPSByb3RhdGVWZWN0b3IoZGF0YVswXSwgc2hpcFkpO1xuXHRcdFx0XHQvLyBcdFx0Y29uc29sZS5sb2coXCJhaW0gcjogXCIsIHJvdGF0ZWQpO1xuXHRcdFx0XHQvLyBcdFx0Ly9hY3Rpb24uc2V0QXR0cmlidXRlKCdsb29rLWF0Jywgcm90YXRlZCk7XG5cdFx0XHRcdC8vIFx0XHRhY3Rpb24uc2V0QXR0cmlidXRlKCdyb3RhdGlvbicsICcwICcgKyAoZGVncmVlLXNoaXBZKSArICcgMCcpO1xuXHRcdFx0XHQvLyBcdFx0Ly9hY3Rpb24ucmVtb3ZlQXR0cmlidXRlKCdsb29rLWF0Jyk7XG5cdFx0XHRcdC8vIFx0fVxuXHRcdFx0XHQvLyB9XG5cblx0XHRcdFx0cmVzb2x2ZSgpO1x0XHRcdFx0XG5cdFx0XHR9KTtcblxuXHRcdH0sXG5cblx0XHRoaXRTaGlwOiAoZGF0YSkgPT4ge1xuXHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblx0XHRcdFx0dmFyIHNoaXAgPSBtX2VudGl0eVtkYXRhWzBdLmlkXTtcblx0XHRcdFx0dmFyIGhlYXJ0ID0gXCJcIjtcblxuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGRhdGFbMF0uaGVhbHRoOyBpKyspIHtcblx0XHRcdFx0XHRoZWFydCArPSBcIiDigKJcIjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgc2hpcC5jaGlsZE5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0aWYgKHNoaXAuY2hpbGROb2Rlc1tpXS5jbGFzc05hbWUgPT0gXCJzaGlwLWhlYWx0aFwiKSB7XG5cdFx0XHRcdFx0XHRzaGlwLmNoaWxkTm9kZXNbaV0uc2V0QXR0cmlidXRlKCd0ZXh0LWdlb21ldHJ5JywgJ3ZhbHVlOiAnK2hlYXJ0Kyc7Jyk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHR9KTtcblx0XHR9LFxuXG5cdFx0Ly8gRGF0YSBwYXNzZWQgaW4gbXVzdCBiZSBmb3IgbW92ZW1lbnQgb2Ygb25lIHNoaXBcblx0XHRtb3ZlU2hpcDogKGRhdGEpID0+IHtcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRcdHZhciBzaGlwRG9tID0gbV9lbnRpdHlbZGF0YVswXS5pZF07IC8vIGh0bWwgZWxlbWVudFxuXHRcdFx0XHQvLyBpZiBzdGF0ZW1lbnQgaXMgbm90IHdvcmtpbmdcblx0XHRcdFx0Ly8gaWYgKGRhdGEubGVuZ3RoID09PSAxICYmIGRhdGFbMF0ueCA9PT0gc2hpcERvbS5kYXRhc2V0LnggJiYgZGF0YVswXS56ID09PSBzaGlwRG9tLmRhdGFzZXQueikge1xuXHRcdFx0XHQvLyAgICAgLy8gaWYgc2hpcERvbSB0cmllcyB0byBtb3ZlIGFnYWluc3QgZWRnZSBvciBvY2N1cGllZCBwbGFjZVxuXHRcdFx0XHQvLyAgICAgYWxlcnQoXCJTa2lwcGVkXCIpO1xuXHRcdFx0XHQvLyAgICAgcmVzb2x2ZShcIlNraXBwZWRcIik7XG5cdFx0XHRcdC8vIH1cblxuXHRcdFx0XHR2YXIgZG9jID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjZW5lJyk7IC8vIDxhLXNjZW5lPiByZWZlcmVuY2Vcblx0XHRcdFx0dmFyIHRyYWNrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyYWNrJyk7XG5cdFx0XHRcdC8vdmFyIHN0YXJ0Q29vcmQgPSB7XCJ4XCI6IGRhdGFbMF0ueH07XG5cblx0XHRcdFx0dmFyIGRlYnVnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1kcmF3LWN1cnZlJyk7XG5cdFx0XHRcdGRlYnVnLnNldEF0dHJpYnV0ZSgnY3VydmVyZWYnLCAnI3RyYWNrJyk7XG5cdFx0XHRcdGRlYnVnLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCAnc2hhZGVyOiBsaW5lOyBjb2xvcjogYmx1ZTsnKTtcblx0XHRcdFx0ZG9jLmFwcGVuZENoaWxkKGRlYnVnKTtcblxuXHRcdFx0XHQvLyBhZGQgY3VycmVudCBsb2NhdGlvbiBhcyBhIHN0YXJ0aW5nIHBvaW50IG9mIHRoZSBjdXJ2ZVxuXHRcdFx0XHR2YXIgcG9pbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWN1cnZlLXBvaW50Jyk7XG5cdFx0XHRcdHBvaW50LnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBTdHJpbmcoc2hpcERvbS5kYXRhc2V0LnggKyBcIiBcIiArIHNoaXBEb20uZGF0YXNldC55ICsgXCIgXCIgKyBzaGlwRG9tLmRhdGFzZXQueikpO1xuXHRcdFx0XHR0cmFjay5hcHBlbmRDaGlsZChwb2ludCk7XG5cdFx0XHRcdC8vIGFkZCBjaGFpbi1hYmxlIGdvYWwgbG9jYXRpb25zIHRvIHRoZSBjdXJ2ZVxuXHRcdFx0XHRcblx0XHRcdFx0Ly9wcmV2aW91cyBpcyB1c2VkIHRvIGNoZWNrIGZvciBtb3ZlbWVudCBhZ2FpbnN0IHdhbGxzLCBlLmcuIHByZXZpb3VzIGxvY2F0aW9uIHNhbWUgYXMgY3VycmVudCBhbmQgbmV4dFxuXHRcdFx0XHQvL3ByZXZpb3VzIGNhbiBhbHNvIGJlIHVzZWQgdG8gZ2V0IHRoZSBsYXN0IGFjdGlvbiB3aGljaCBkZXRlcm1pbmVzIHRoZSBmaW5hbCByb3RhdGlvbiB3aGVyZSB0aGUgc2hpcCBzaG91bGQgcG9pbnRcblx0XHRcdFx0dmFyIHByZXZpb3VzID0geyd4Jzogc2hpcERvbS5kYXRhc2V0LngsICd6Jzogc2hpcERvbS5kYXRhc2V0Lnp9O1xuXHRcdFx0XHR2YXIgeERpc3RhbmNlID0gMDtcblx0XHRcdFx0dmFyIHpEaXN0YW5jZSA9IDA7XG5cdFx0XHRcdC8vY29uc29sZS5sb2coXCJNb3Zpbmc6IFwiLCBkYXRhKTtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0cG9pbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWN1cnZlLXBvaW50Jyk7XG5cdFx0XHRcdFx0cG9pbnQuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIGRhdGFbaV0ueCArIFwiIFwiICsgZGF0YVtpXS55ICsgXCIgXCIgKyBkYXRhW2ldLnopO1xuXHRcdFx0XHRcdHhEaXN0YW5jZSArPSBNYXRoLmFicyhkYXRhW2ldLnggLSBwcmV2aW91cy54KTtcblx0XHRcdFx0XHR6RGlzdGFuY2UgKz0gTWF0aC5hYnMoZGF0YVtpXS56IC0gcHJldmlvdXMueik7XG5cdFx0XHRcdFx0aWYgKGkgKyAxIDwgZGF0YS5sZW5ndGggJiYgZGF0YVtpXS54ID09PSBkYXRhW2krMV0ueCAmJiBkYXRhW2ldLnogPT09IGRhdGFbaSsxXS56KSB7XG5cdFx0XHRcdFx0XHRpKys7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHRyYWNrLmFwcGVuZENoaWxkKHBvaW50KTtcblx0XHRcdFx0XHRwcmV2aW91cyA9IHsneCc6IGRhdGFbaV0ueCwgJ3onOiBkYXRhW2ldLnosICdkaXJlY3Rpb24nOiBkYXRhW2ldLmRpcmVjdGlvbn07XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgZHVyID0gKHhEaXN0YW5jZSt6RGlzdGFuY2UpKm1fQ29uc3RhbnRzLldhaXRUaW1lUGVyVGlsZU1vdmVkOyAvLyBkZXRlcm1pbmVzIHRoZSBsZW5ndGggaW4gdGltZSBvZiB0aGUgbW92ZW1lbnQgXG5cdFx0XHRcdHNoaXBEb20uc2V0QXR0cmlidXRlKCdhbG9uZ3BhdGgnLCAnY3VydmU6ICN0cmFjazsgcm90YXRlOiB0cnVlOyBjb25zdHJhaW50OiAwIDAgLTE7IGRlbGF5OiAnK21fQ29uc3RhbnRzLldhaXRUaW1lQmV0d2VlbkFjdGlvbisnOyBkdXI6ICcrZHVyKyc7Jyk7XG5cblx0XHRcdFx0dmFyIGRvbmUgPSAoZXZlbnQpID0+IHtcblx0XHRcdFx0XHQvLyB2YXIgbGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeVRhZ05hbWUoJ2EtZHJhdy1jdXJ2ZScpO1xuXHRcdFx0XHRcdC8vIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdC8vICAgICBsaXN0WzBdLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobGlzdFswXSk7XG5cdFx0XHRcdFx0Ly8gfVxuXHRcdFx0XHRcdGlmIChkZWJ1Zy5wYXJlbnROb2RlKSB7XG5cdFx0XHRcdFx0XHRkb2MucmVtb3ZlQ2hpbGQoZGVidWcpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHdoaWxlKHRyYWNrLmhhc0NoaWxkTm9kZXMoKSkge1xuXHRcdFx0XHRcdFx0dHJhY2sucmVtb3ZlQ2hpbGQodHJhY2suY2hpbGROb2Rlc1swXSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHNoaXBEb20ucmVtb3ZlQXR0cmlidXRlKCdhbG9uZ3BhdGgnKTtcblx0XHRcdFx0XHRzaGlwRG9tLmRhdGFzZXQueCA9IGRhdGFbZGF0YS5sZW5ndGgtMV0ueDtcblx0XHRcdFx0XHRzaGlwRG9tLmRhdGFzZXQueiA9IGRhdGFbZGF0YS5sZW5ndGgtMV0uejtcblx0XHRcdFx0XHRzaGlwRG9tLmRhdGFzZXQueSA9IGRhdGFbZGF0YS5sZW5ndGgtMV0ueTtcblxuXHRcdFx0XHRcdC8vc2hpcERvbS5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3ZpbmdlbmRlZCcsIGRvbmUpO1xuXHRcdFx0XHRcdHJlc29sdmUoZXZlbnQpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHNoaXBEb20uYWRkRXZlbnRMaXN0ZW5lcignbW92aW5nZW5kZWQnLCBkb25lKTtcblx0XHRcdFx0XG5cdFx0XHR9KTtcblx0XHR9LFxuXG5cdFx0c2ltdWxhdGU6ICgpID0+IHtcblx0XHRcdC8vY29uc29sZS5sb2coXCJjaGFpbjogXCIsIG1fY2hhaW4pO1xuXHRcdFx0dmFyIG5vdFN0b3AgPSB0cnVlO1xuXHRcdFx0aWYgKG1fY2hhaW4ubGVuZ3RoID09IDApIHtcblx0XHRcdFx0bm90U3RvcCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0dmFyIGN1cnJlbnQgPSBtX2NoYWluLnNoaWZ0KCk7IC8vIGRvbid0IHNoaWZ0IHdoZW4gbGVuZ3RoIGlzIHplcm9cblx0XHRcdGlmIChjdXJyZW50ICYmIG5vdFN0b3ApIHtcblx0XHRcdFx0Ly9jb25zb2xlLmxvZyhcImN1cnJlbnQ6IFwiLCBjdXJyZW50KTtcblx0XHRcdFx0c3dpdGNoKGN1cnJlbnQudHlwZSkge1xuXHRcdFx0XHRcdGNhc2UgXCJNT1ZFXCI6XG5cdFx0XHRcdFx0XHRhcHAubW92ZVNoaXAoY3VycmVudC5hY3Rpb25zKS50aGVuKChkb25lKSA9PiB7XG5cdFx0XHRcdFx0XHRcdC8vYWxlcnQoXCJNb3ZlZCBcIiArIG1fY2hhaW4ubGVuZ3RoICsgXCIgYWN0aW9ucyBsZWZ0XCIpO1xuXHRcdFx0XHRcdFx0XHRhcHAuc2ltdWxhdGUoKTtcblx0XHRcdFx0XHRcdH0pLmNhdGNoKChlcnIpID0+IHtcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5lcnJvcihlcnIpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRjYXNlIFwiRklSRVwiOlxuXHRcdFx0XHRcdFx0LyoqKiBFeGNsdXNpdmUgT3IgZnVuY3Rpb25zICoqKi9cblxuXHRcdFx0XHRcdFx0LyogRmlyZSB3aXRob3V0IGFpbWluZyAqL1xuXHRcdFx0XHRcdFx0YXBwLmZpcmVTaGlwKGN1cnJlbnQuYWN0aW9ucykudGhlbigoZG9uZSkgPT4ge1xuXHRcdFx0XHRcdFx0XHRhcHAuc2ltdWxhdGUoKTtcblx0XHRcdFx0XHRcdH0pLmNhdGNoKChlcnIpID0+IHtcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5lcnJvcihcImVycm9yOiBcIiwgZXJyKTtcdFxuXHRcdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRcdC8vIC8qIEFpbSB0aGVuIGZpcmUgKGN1cnJlbnRseSBidWdneSkqL1xuXHRcdFx0XHRcdFx0Ly8gYXBwLmFpbVNoaXAoY3VycmVudC5hY3Rpb25zKS50aGVuKChkb25lKSA9PiB7XG5cdFx0XHRcdFx0XHQvLyBcdGFwcC5maXJlU2hpcChjdXJyZW50LmFjdGlvbnMpLnRoZW4oKGRvbmUpID0+IHtcblx0XHRcdFx0XHRcdC8vIFx0XHRhcHAuc2ltdWxhdGUoKTtcblx0XHRcdFx0XHRcdC8vIFx0fSkuY2F0Y2goKGVycikgPT4ge1xuXHRcdFx0XHRcdFx0Ly8gXHRcdGNvbnNvbGUuZXJyb3IoXCJlcnJvcjogXCIsIGVycik7XHRcblx0XHRcdFx0XHRcdC8vIFx0fSk7XG5cdFx0XHRcdFx0XHQvLyB9KS5jYXRjaCgoZXJyKSA9PiB7XG5cdFx0XHRcdFx0XHQvLyBcdGNvbnNvbGUuZXJyb3IoXCJlcnJvcjogXCIsIGVycik7XG5cdFx0XHRcdFx0XHQvLyB9KTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgXCJISVRcIjpcblx0XHRcdFx0XHRcdGFwcC5oaXRTaGlwKGN1cnJlbnQuYWN0aW9ucykudGhlbigoZG9uZSkgPT4ge1xuXHRcdFx0XHRcdFx0XHRhcHAuc2ltdWxhdGUoKTtcblx0XHRcdFx0XHRcdH0pLmNhdGNoKChlcnIpID0+IHtcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coZXJyKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSBcIlNJTktcIjpcblx0XHRcdFx0XHRcdGFwcC5zaW5rU2hpcChjdXJyZW50LmFjdGlvbnMpLnRoZW4oKGRvbmUpID0+IHtcblx0XHRcdFx0XHRcdFx0Ly9hbGVydChcIlN1bmsgXCIrIG1fY2hhaW4ubGVuZ3RoICsgXCIgYWN0aW9ucyBsZWZ0XCIpO1xuXHRcdFx0XHRcdFx0XHRhcHAuc2ltdWxhdGUoKTtcblx0XHRcdFx0XHRcdH0pLmNhdGNoKChlcnIpID0+IHtcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5lcnJvcihlcnIpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiVW5rbm93biBBY3Rpb24gVHlwZSBcIiArIGN1cnJlbnQudHlwZSArIFwiIGluIHNpbXVsYXRlIGZ1bmN0aW9uLCBza2lwcGluZy5cIik7XG5cdFx0XHRcdFx0XHRhcHAuc2ltdWxhdGUoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0Ly9hbGVydChcIlNpbXVsYXRpb24gRG9uZVwiKTtcblx0XHRcdFx0XHR2ZXguZGlhbG9nLmFsZXJ0KFwiU2ltdWxhdGlvbiBDb21wbGV0ZWQuXCIpO1xuXHRcdFx0XHR9LCAxMDAwKTtcblx0XHRcdH1cblxuXHRcdH0sXG5cblx0XHQvKiogdHJhbnNsYXRlcyB0aGUgY29vcmRpbmF0ZSBpbiB0aGUgamF2YSBnYW1lIHRvIHRoaXMgc2NlbmUncyBjb29yZGluYXRlXG5cdFx0XHRKYXZhIEdhbWU6IEVhY2ggc2hpcCBzcGFucyBvbmUgKHgsIHkpIHVuaXRcblx0XHRcdEphdmEgR2FtZTogQ29vcmRpbmF0ZSBzeXN0ZW0gaGFzICgwLCAwKSBhdCB0b3AgbGVmdCBjb3JuZXIgKHdpdGhvdXQgbmVnYXRpdmVzKVxuXHRcdFx0QUZyYW1lIFNjZW5lOiBFYWNoIHNoaXAgbW9kZWwgaXMgYSA0eDQgYm94XG5cdFx0XHRBRnJhbWUgU2NlbmU6IENvb3JkaW5hdGUgc3lzdGVtIGlzICgwLCAwKSBhdCB0aGUgY2VudGVyICh3aXRoIG5lZ2F0aXZlcylcblx0XHQqL1xuXHRcdGdldFN0ckNvb3JkOiAoY29vcmQsIG9mZnNldFkpID0+IHtcblx0XHRcdHJldHVybiAobV9vY2Vhbi54LWNvb3JkLngpKjQgKyBcIiBcIiArIG9mZnNldFkgKyBcIiBcIiArIChtX29jZWFuLnktY29vcmQueSkqNDtcblx0XHR9LFxuXG5cdFx0Z2V0U2hpcHM6ICgpID0+IHtcblx0XHRcdHJldHVybiBtX3NoaXBzO1xuXHRcdH0sXG5cblx0XHRnZXRPY2VhbjogKCkgPT4ge1xuXHRcdFx0cmV0dXJuIG1fb2NlYW47XG5cdFx0fVxuXG5cblx0fVxuXG5cdHJldHVybiBhcHA7XG59XG5cbnZhciBhcHAgPSBiYXR0bGVzaGlwKCk7XG5sZXQgcGFyYW1zID0gZ2V0UXVlcnlQYXJhbXMoZG9jdW1lbnQubG9jYXRpb24uc2VhcmNoKTtcblxubGV0IGdldERhdGFGcm9tQ29kZSA9IChjb2RlKSA9PiB7XG5cdGRiLnJlZignZGF2eS1qb25lcy1sb2NrZXIvJyArIGNvZGUpLm9uY2UoJ3ZhbHVlJywgKHNuYXBzaG90KSA9PiB7XG5cdFx0dmFyIGdhbWVEYXRhID0gc25hcHNob3QudmFsKCk7XG5cdFx0aWYgKGdhbWVEYXRhKSB7XG5cdFx0XHRpbnB1dCA9IGdhbWVEYXRhO1xuXHRcdFx0YXBwLmluaXQoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Z2V0Q29kZShgTm8gZGF0YSBmb3IgY29kZSAke2NvZGV9LiBFbnRlciBhbm90aGVyIGNvZGU6YCk7XG5cdFx0XHQvL2FwcC5pbml0KCk7XG5cdFx0fVxuXHR9KS5jYXRjaCgoZXJyKSA9PiB7XG5cdFx0Z2V0Q29kZShgVGhlcmUgd2FzIGFuIGVycm9yLiBFbnRlciBhbm90aGVyIGNvZGU6YCk7XG5cdFx0Ly9hcHAuaW5pdCgpO1xuXHR9KTtcbn1cblxubGV0IGdldENvZGUgPSAobWVzc2FnZSkgPT4ge1xuXHR2ZXguZGlhbG9nLnByb21wdCh7XG5cdFx0bWVzc2FnZTogbWVzc2FnZSxcblx0XHRjYWxsYmFjazogKHZhbHVlKSA9PiB7XG5cdFx0XHRpZiAodmFsdWUpIHtcblx0XHRcdFx0dmFyIGNvZGUgPSB2YWx1ZTtcblx0XHRcdFx0Z2V0RGF0YUZyb21Db2RlKGNvZGUpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Z2V0Q29kZShcIk5vIGNvZGUgZW50ZXJlZC4gRW50ZXIgeW91ciBjb2RlOlwiKTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xufVxuXG5pZiAocGFyYW1zLmNvZGUpIHtcblx0Z2V0RGF0YUZyb21Db2RlKHBhcmFtcy5jb2RlKTtcbn0gZWxzZSB7XG5cdGdldENvZGUoXCJFbnRlciBZb3VyIENvZGVcIik7XG59XG5cblxuLy8gdmFyIEJBVFRMRV9TRVJWRVJfVVJMID0gJ2h0dHBzOi8vYmF0dGxlc2hpcC12aW5na2FuLmM5dXNlcnMuaW8vMXYxP3AxPWVzaTE3LmNzLkRlc3Ryb3llclNoaXAmcDI9ZXNpMTcuaGxpMTA5LkZsb2F0ZXInOy8vICsgTWF0aC5jZWlsKE1hdGgucmFuZG9tKCkgKiAxMDApO1xuXG4vLyAkLmdldChCQVRUTEVfU0VSVkVSX1VSTCkudGhlbihkYXRhID0+IHtcbi8vIFx0aW5wdXQgPSBkYXRhO1xuLy8gXHRhcHAuaW5pdCgpO1xuLy8gfSkuZG9uZSgoKSA9PiB7XG4vLyBcdGNvbnNvbGUubG9nKFwiRGF0YSBzdWNjZXNzZnVsbHkgcmV0cmlldmVkIGZyb20gc2VydmVyXCIpO1xuLy8gfSkuZmFpbCgoKSA9PiB7XG4vLyBcdGNvbnNvbGUubG9nKFwiVW5hYmxlIHRvIHJldHJpZXZlIGRhdGEsIHN0YXJ0aW5nIHdpdGggbG9jYWwgZGF0YVwiKTtcbi8vIFx0YXBwLmluaXQoKTtcbi8vIH0pO1xuXG5cblxuIl19\n"]}