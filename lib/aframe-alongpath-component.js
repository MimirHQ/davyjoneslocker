!function t(e,i,r){function a(s,n){if(!i[s]){if(!e[s]){var g="function"==typeof require&&require;if(!n&&g)return g(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){var i=e[s][1][t];return a(i||t)},c,c.exports,t,e,i,r)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)a(r[s]);return a}({1:[function(t,e,i){"use strict";!function(t){function e(r){if(i[r])return i[r].exports;var a=i[r]={exports:{},id:r,loaded:!1};return t[r].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var i={};e.m=t,e.c=i,e.p="",e(0)}([function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("alongpath",{schema:{curve:{default:""},triggers:{default:"a-curve-point"},triggerRadius:{type:"number",default:.01},dur:{default:1e3},delay:{default:0},loop:{default:!1},rotate:{default:!1},constraint:{type:"vec3",default:{x:0,y:0,z:1}},resetonplay:{default:!0}},init:function(){},update:function(t){this.curve=document.querySelector(this.data.curve),this.triggers=this.curve.querySelectorAll(this.data.triggers),this.curve?this.initialPosition=this.el.object3D.position:console.warn("Curve not found. Can't follow anything..."),this.reset()},reset:function(){this.interval=0,this.el.removeState("endofpath"),this.el.removeState("moveonpath"),this.activeTrigger&&(this.activeTrigger.removeState("alongpath-active-trigger"),this.activeTrigger=null)},tick:function(t,e){var i=this.curve.components.curve?this.curve.components.curve.curve:null;if(i){if(!this.el.is("endofpath")){this.interval=this.interval+e;var r=0;if(r=this.interval-this.data.delay>=this.data.dur?1:this.interval-this.data.delay<0?0:(this.interval-this.data.delay)/this.data.dur,!1===this.data.loop&&r>=1)this.el.setAttribute("position",i.points[i.points.length-1]),this.el.removeState("moveonpath"),this.el.addState("endofpath"),this.el.emit("movingended");else if(!0===this.data.loop&&r>=1)this.el.emit("movingended"),this.interval=this.data.delay;else{this.el.is("moveonpath")||(this.el.addState("moveonpath"),this.el.emit("movingstarted"));var a=i.getPoint(r);this.el.setAttribute("position",a)}if(!0===this.data.rotate){var o=new THREE.Vector3,s=new THREE.Vector3(this.data.constraint.x,this.data.constraint.y,this.data.constraint.z),n=i.getTangentAt(r).normalize();o.crossVectors(s,n).normalize();var g=Math.acos(s.dot(n));this.el.object3D.quaternion.setFromAxisAngle(o,g)}this.triggers&&this.triggers.length>0&&this.updateActiveTrigger()}}else console.error("The entity associated with the curve property has no curve component.")},play:function(){this.data.resetonplay&&this.reset()},remove:function(){this.el.object3D.position.copy(this.initialPosition)},updateActiveTrigger:function(){for(var t=0;t<this.triggers.length;t++)if(this.triggers[t].object3D){if(this.triggers[t].object3D.position.distanceTo(this.el.object3D.position)<=this.data.triggerRadius){this.activeTrigger&&this.activeTrigger!=this.triggers[t]?(this.activeTrigger.removeState("alongpath-active-trigger"),this.activeTrigger.emit("alongpath-trigger-deactivated"),this.activeTrigger=this.triggers[t],this.activeTrigger.addState("alongpath-active-trigger"),this.activeTrigger.emit("alongpath-trigger-activated")):this.activeTrigger||(this.activeTrigger=this.triggers[t],this.activeTrigger.addState("alongpath-active-trigger"),this.activeTrigger.emit("alongpath-trigger-activated"));break}this.activeTrigger&&this.activeTrigger==this.triggers[t]&&(this.activeTrigger.removeState("alongpath-active-trigger"),this.activeTrigger.emit("alongpath-trigger-deactivated"),this.activeTrigger=null)}}})}])},{}]},{},[1]);
//# sourceMappingURL=maps/aframe-alongpath-component.js.map
